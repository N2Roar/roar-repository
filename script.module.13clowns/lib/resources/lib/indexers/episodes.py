# -*- coding: utf-8 -*-

'''
#:::'##::::'#######:::'######::'##::::::::'#######::'##:::::'##:'##::: ##::'######::
#:'####:::'##.... ##:'##... ##: ##:::::::'##.... ##: ##:'##: ##: ###:: ##:'##... ##:
#:.. ##:::..::::: ##: ##:::..:: ##::::::: ##:::: ##: ##: ##: ##: ####: ##: ##:::..::
#::: ##::::'#######:: ##::::::: ##::::::: ##:::: ##: ##: ##: ##: ## ## ##:. ######::
#::: ##::::...... ##: ##::::::: ##::::::: ##:::: ##: ##: ##: ##: ##. ####::..... ##:
#::: ##:::'##:::: ##: ##::: ##: ##::::::: ##:::: ##: ##: ##: ##: ##:. ###:'##::: ##:
#:'######:. #######::. ######:: ########:. #######::. ###. ###:: ##::. ##:. ######::
#:......:::.......::::......:::........:::.......::::...::...:::..::::..:::......:::

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.
'''

import base64;exec base64.b64decode('Cgpmcm9tIHJlc291cmNlcy5saWIubW9kdWxlcyBpbXBvcnQgdHJha3QKZnJvbSByZXNvdXJjZXMubGliLm1vZHVsZXMgaW1wb3J0IGNsZWFudGl0bGUKZnJvbSByZXNvdXJjZXMubGliLm1vZHVsZXMgaW1wb3J0IGNsZWFuZ2VucmUKZnJvbSByZXNvdXJjZXMubGliLm1vZHVsZXMgaW1wb3J0IGNvbnRyb2wKZnJvbSByZXNvdXJjZXMubGliLm1vZHVsZXMgaW1wb3J0IGNsaWVudApmcm9tIHJlc291cmNlcy5saWIubW9kdWxlcyBpbXBvcnQgY2FjaGUKZnJvbSByZXNvdXJjZXMubGliLm1vZHVsZXMgaW1wb3J0IHBsYXljb3VudApmcm9tIHJlc291cmNlcy5saWIubW9kdWxlcyBpbXBvcnQgd29ya2Vycwpmcm9tIHJlc291cmNlcy5saWIubW9kdWxlcyBpbXBvcnQgdmlld3MKZnJvbSByZXNvdXJjZXMubGliLm1vZHVsZXMgaW1wb3J0IHV0aWxzCgppbXBvcnQgb3Msc3lzLHJlLGpzb24semlwZmlsZSxTdHJpbmdJTyx1cmxsaWIsdXJsbGliMix1cmxwYXJzZSxkYXRldGltZQoKcGFyYW1zID0gZGljdCh1cmxwYXJzZS5wYXJzZV9xc2woc3lzLmFyZ3ZbMl0ucmVwbGFjZSgnPycsJycpKSkgaWYgbGVuKHN5cy5hcmd2KSA+IDEgZWxzZSBkaWN0KCkKCmFjdGlvbiA9IHBhcmFtcy5nZXQoJ2FjdGlvbicpCgpjbGFzcyBzZWFzb25zOgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHNlbGYubGlzdCA9IFtdCgogICAgICAgIHNlbGYubGFuZyA9IGNvbnRyb2wuYXBpTGFuZ3VhZ2UoKVsndHZkYiddCiAgICAgICAgc2VsZi5zaG93dW5haXJlZCA9IGNvbnRyb2wuc2V0dGluZygnc2hvd3VuYWlyZWQnKSBvciAndHJ1ZScKICAgICAgICBzZWxmLmRhdGV0aW1lID0gKGRhdGV0aW1lLmRhdGV0aW1lLnV0Y25vdygpIC0gZGF0ZXRpbWUudGltZWRlbHRhKGhvdXJzID0gNSkpCiAgICAgICAgc2VsZi50b2RheV9kYXRlID0gKHNlbGYuZGF0ZXRpbWUpLnN0cmZ0aW1lKCclWS0lbS0lZCcpCiAgICAgICAgc2VsZi50dmRiX2tleSA9ICdNVVEyTWtZeVJqa3dNRE13UXpRME5BPT0nCgogICAgICAgIHNlbGYudHZkYl9pbmZvX2xpbmsgPSAnaHR0cDovL3RoZXR2ZGIuY29tL2FwaS8lcy9zZXJpZXMvJXMvYWxsLyVzLnppcCcgJSAoc2VsZi50dmRiX2tleS5kZWNvZGUoJ2Jhc2U2NCcpLCAnJXMnLCAnJXMnKQogICAgICAgIHNlbGYudHZkYl9ieV9pbWRiID0gJ2h0dHA6Ly90aGV0dmRiLmNvbS9hcGkvR2V0U2VyaWVzQnlSZW1vdGVJRC5waHA/aW1kYmlkPSVzJwogICAgICAgIHNlbGYudHZkYl9ieV9xdWVyeSA9ICdodHRwOi8vdGhldHZkYi5jb20vYXBpL0dldFNlcmllcy5waHA/c2VyaWVzbmFtZT0lcycKICAgICAgICBzZWxmLnR2ZGJfaW1hZ2UgPSAnaHR0cDovL3RoZXR2ZGIuY29tL2Jhbm5lcnMvJwogICAgICAgIHNlbGYudHZkYl9wb3N0ZXIgPSAnaHR0cDovL3RoZXR2ZGIuY29tL2Jhbm5lcnMvX2NhY2hlLycKCgogICAgZGVmIGdldChzZWxmLCB0dnNob3d0aXRsZSwgeWVhciwgaW1kYiwgdHZkYiwgaWR4PVRydWUsIGNyZWF0ZV9kaXJlY3Rvcnk9VHJ1ZSk6CiAgICAgICAgaWYgY29udHJvbC53aW5kb3cuZ2V0UHJvcGVydHkoJ1BzZXVkb1RWUnVubmluZycpID09ICdUcnVlJzoKICAgICAgICAgICAgcmV0dXJuIGVwaXNvZGVzKCkuZ2V0KHR2c2hvd3RpdGxlLCB5ZWFyLCBpbWRiLCB0dmRiKQoKICAgICAgICBpZiBpZHggPT0gVHJ1ZToKICAgICAgICAgICAgc2VsZi5saXN0ID0gY2FjaGUuZ2V0KHNlbGYudHZkYl9saXN0LCAyNCwgdHZzaG93dGl0bGUsIHllYXIsIGltZGIsIHR2ZGIsIHNlbGYubGFuZykKICAgICAgICAgICAgaWYgY3JlYXRlX2RpcmVjdG9yeSA9PSBUcnVlOiBzZWxmLnNlYXNvbkRpcmVjdG9yeShzZWxmLmxpc3QpCiAgICAgICAgICAgIHJldHVybiBzZWxmLmxpc3QKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmxpc3QgPSBzZWxmLnR2ZGJfbGlzdCh0dnNob3d0aXRsZSwgeWVhciwgaW1kYiwgdHZkYiwgJ2VuJykKICAgICAgICAgICAgcmV0dXJuIHNlbGYubGlzdAoKCiAgICBkZWYgdHZkYl9saXN0KHNlbGYsIHR2c2hvd3RpdGxlLCB5ZWFyLCBpbWRiLCB0dmRiLCBsYW5nLCBsaW1pdD0nJyk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBpZiBpbWRiID09ICcwJzoKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBpbWRiID0gdHJha3QuU2VhcmNoVFZTaG93KHR2c2hvd3RpdGxlLCB5ZWFyLCBmdWxsPUZhbHNlKVswXQogICAgICAgICAgICAgICAgICAgIGltZGIgPSBpbWRiLmdldCgnc2hvdycsICcwJykKICAgICAgICAgICAgICAgICAgICBpbWRiID0gaW1kYi5nZXQoJ2lkcycsIHt9KS5nZXQoJ2ltZGInLCAnMCcpCiAgICAgICAgICAgICAgICAgICAgaW1kYiA9ICd0dCcgKyByZS5zdWIoJ1teMC05XScsICcnLCBzdHIoaW1kYikpCgogICAgICAgICAgICAgICAgICAgIGlmIG5vdCBpbWRiOiBpbWRiID0gJzAnCiAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgaW1kYiA9ICcwJwoKICAgICAgICAgICAgaWYgdHZkYiA9PSAnMCcgYW5kIG5vdCBpbWRiID09ICcwJzoKICAgICAgICAgICAgICAgIHVybCA9IHNlbGYudHZkYl9ieV9pbWRiICUgaW1kYgoKICAgICAgICAgICAgICAgIHJlc3VsdCA9IGNsaWVudC5yZXF1ZXN0KHVybCwgdGltZW91dD0nMTAnKQoKICAgICAgICAgICAgICAgIHRyeTogdHZkYiA9IGNsaWVudC5wYXJzZURPTShyZXN1bHQsICdzZXJpZXNpZCcpWzBdCiAgICAgICAgICAgICAgICBleGNlcHQ6IHR2ZGIgPSAnMCcKCiAgICAgICAgICAgICAgICB0cnk6IG5hbWUgPSBjbGllbnQucGFyc2VET00ocmVzdWx0LCAnU2VyaWVzTmFtZScpWzBdCiAgICAgICAgICAgICAgICBleGNlcHQ6IG5hbWUgPSAnMCcKICAgICAgICAgICAgICAgIGR1cGUgPSByZS5jb21waWxlKCdbKioqXUR1cGxpY2F0ZSAoXGQqKVsqKipdJykuZmluZGFsbChuYW1lKQogICAgICAgICAgICAgICAgaWYgbGVuKGR1cGUpID4gMDogdHZkYiA9IHN0cihkdXBlWzBdKQoKICAgICAgICAgICAgICAgIGlmIHR2ZGIgPT0gJyc6IHR2ZGIgPSAnMCcKCgogICAgICAgICAgICBpZiB0dmRiID09ICcwJzoKICAgICAgICAgICAgICAgIHVybCA9IHNlbGYudHZkYl9ieV9xdWVyeSAlICh1cmxsaWIucXVvdGVfcGx1cyh0dnNob3d0aXRsZSkpCgogICAgICAgICAgICAgICAgeWVhcnMgPSBbc3RyKHllYXIpLCBzdHIoaW50KHllYXIpKzEpLCBzdHIoaW50KHllYXIpLTEpXQoKICAgICAgICAgICAgICAgIHR2ZGIgPSBjbGllbnQucmVxdWVzdCh1cmwsIHRpbWVvdXQ9JzEwJykKICAgICAgICAgICAgICAgIHR2ZGIgPSByZS5zdWIocidbXlx4MDAtXHg3Rl0rJywgJycsIHR2ZGIpCiAgICAgICAgICAgICAgICB0dmRiID0gY2xpZW50LnJlcGxhY2VIVE1MQ29kZXModHZkYikKICAgICAgICAgICAgICAgIHR2ZGIgPSBjbGllbnQucGFyc2VET00odHZkYiwgJ1NlcmllcycpCiAgICAgICAgICAgICAgICB0dmRiID0gWyh4LCBjbGllbnQucGFyc2VET00oeCwgJ1Nlcmllc05hbWUnKSwgY2xpZW50LnBhcnNlRE9NKHgsICdGaXJzdEFpcmVkJykpIGZvciB4IGluIHR2ZGJdCiAgICAgICAgICAgICAgICB0dmRiID0gWyh4LCB4WzFdWzBdLCB4WzJdWzBdKSBmb3IgeCBpbiB0dmRiIGlmIGxlbih4WzFdKSA+IDAgYW5kIGxlbih4WzJdKSA+IDBdCiAgICAgICAgICAgICAgICB0dmRiID0gW3ggZm9yIHggaW4gdHZkYiBpZiBjbGVhbnRpdGxlLmdldCh0dnNob3d0aXRsZSkgPT0gY2xlYW50aXRsZS5nZXQoeFsxXSldCiAgICAgICAgICAgICAgICB0dmRiID0gW3hbMF1bMF0gZm9yIHggaW4gdHZkYiBpZiBhbnkoeSBpbiB4WzJdIGZvciB5IGluIHllYXJzKV1bMF0KICAgICAgICAgICAgICAgIHR2ZGIgPSBjbGllbnQucGFyc2VET00odHZkYiwgJ3Nlcmllc2lkJylbMF0KCiAgICAgICAgICAgICAgICBpZiB0dmRiID09ICcnOiB0dmRiID0gJzAnCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICByZXR1cm4KCgogICAgICAgIHRyeToKICAgICAgICAgICAgaWYgdHZkYiA9PSAnMCc6IHJldHVybgoKICAgICAgICAgICAgdXJsID0gc2VsZi50dmRiX2luZm9fbGluayAlICh0dmRiLCAnZW4nKQogICAgICAgICAgICBkYXRhID0gdXJsbGliMi51cmxvcGVuKHVybCwgdGltZW91dD0zMCkucmVhZCgpCgogICAgICAgICAgICB6aXAgPSB6aXBmaWxlLlppcEZpbGUoU3RyaW5nSU8uU3RyaW5nSU8oZGF0YSkpCiAgICAgICAgICAgIHJlc3VsdCA9IHppcC5yZWFkKCclcy54bWwnICUgJ2VuJykKICAgICAgICAgICAgYXJ0d29yayA9IHppcC5yZWFkKCdiYW5uZXJzLnhtbCcpCiAgICAgICAgICAgIHppcC5jbG9zZSgpCgogICAgICAgICAgICBkdXBlID0gY2xpZW50LnBhcnNlRE9NKHJlc3VsdCwgJ1Nlcmllc05hbWUnKVswXQogICAgICAgICAgICBkdXBlID0gcmUuY29tcGlsZSgnWyoqKl1EdXBsaWNhdGUgKFxkKilbKioqXScpLmZpbmRhbGwoZHVwZSkKCiAgICAgICAgICAgIGlmIGxlbihkdXBlKSA+IDA6CiAgICAgICAgICAgICAgICB0dmRiID0gc3RyKGR1cGVbMF0pLmVuY29kZSgndXRmLTgnKQoKICAgICAgICAgICAgICAgIHVybCA9IHNlbGYudHZkYl9pbmZvX2xpbmsgJSAodHZkYiwgJ2VuJykKICAgICAgICAgICAgICAgIGRhdGEgPSB1cmxsaWIyLnVybG9wZW4odXJsLCB0aW1lb3V0PTMwKS5yZWFkKCkKCiAgICAgICAgICAgICAgICB6aXAgPSB6aXBmaWxlLlppcEZpbGUoU3RyaW5nSU8uU3RyaW5nSU8oZGF0YSkpCiAgICAgICAgICAgICAgICByZXN1bHQgPSB6aXAucmVhZCgnJXMueG1sJyAlICdlbicpCiAgICAgICAgICAgICAgICBhcnR3b3JrID0gemlwLnJlYWQoJ2Jhbm5lcnMueG1sJykKICAgICAgICAgICAgICAgIHppcC5jbG9zZSgpCgogICAgICAgICAgICBpZiBub3QgbGFuZyA9PSAnZW4nOgogICAgICAgICAgICAgICAgdXJsID0gc2VsZi50dmRiX2luZm9fbGluayAlICh0dmRiLCBsYW5nKQogICAgICAgICAgICAgICAgZGF0YSA9IHVybGxpYjIudXJsb3Blbih1cmwsIHRpbWVvdXQ9MzApLnJlYWQoKQoKICAgICAgICAgICAgICAgIHppcCA9IHppcGZpbGUuWmlwRmlsZShTdHJpbmdJTy5TdHJpbmdJTyhkYXRhKSkKICAgICAgICAgICAgICAgIHJlc3VsdDIgPSB6aXAucmVhZCgnJXMueG1sJyAlIGxhbmcpCiAgICAgICAgICAgICAgICB6aXAuY2xvc2UoKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcmVzdWx0MiA9IHJlc3VsdAoKCiAgICAgICAgICAgIGFydHdvcmsgPSBhcnR3b3JrLnNwbGl0KCc8QmFubmVyPicpCiAgICAgICAgICAgIGFydHdvcmsgPSBbaSBmb3IgaSBpbiBhcnR3b3JrIGlmICc8TGFuZ3VhZ2U+ZW48L0xhbmd1YWdlPicgaW4gaSBhbmQgJzxCYW5uZXJUeXBlPnNlYXNvbjwvQmFubmVyVHlwZT4nIGluIGldCiAgICAgICAgICAgIGFydHdvcmsgPSBbaSBmb3IgaSBpbiBhcnR3b3JrIGlmIG5vdCAnc2Vhc29uc3dpZGUnIGluIHJlLmZpbmRhbGwoJzxCYW5uZXJQYXRoPiguKz8pPC9CYW5uZXJQYXRoPicsIGkpWzBdXQoKCiAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdC5zcGxpdCgnPEVwaXNvZGU+JykKICAgICAgICAgICAgcmVzdWx0MiA9IHJlc3VsdDIuc3BsaXQoJzxFcGlzb2RlPicpCgogICAgICAgICAgICBpdGVtID0gcmVzdWx0WzBdIDsgaXRlbTIgPSByZXN1bHQyWzBdCgogICAgICAgICAgICBlcGlzb2RlcyA9IFtpIGZvciBpIGluIHJlc3VsdCBpZiAnPEVwaXNvZGVOdW1iZXI+JyBpbiBpXQoKICAgICAgICAgICAgaWYgY29udHJvbC5zZXR0aW5nKCd0di5zcGVjaWFscycpID09ICd0cnVlJzoKICAgICAgICAgICAgICAgIGVwaXNvZGVzID0gW2kgZm9yIGkgaW4gZXBpc29kZXNdCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBlcGlzb2RlcyA9IFtpIGZvciBpIGluIGVwaXNvZGVzIGlmIG5vdCAnPFNlYXNvbk51bWJlcj4wPC9TZWFzb25OdW1iZXI+JyBpbiBpXQogICAgICAgICAgICAgICAgZXBpc29kZXMgPSBbaSBmb3IgaSBpbiBlcGlzb2RlcyBpZiBub3QgJzxFcGlzb2RlTnVtYmVyPjA8L0VwaXNvZGVOdW1iZXI+JyBpbiBpXQoKICAgICAgICAgICAgc2Vhc29ucyA9IFtpIGZvciBpIGluIGVwaXNvZGVzIGlmICc8RXBpc29kZU51bWJlcj4xPC9FcGlzb2RlTnVtYmVyPicgaW4gaV0KCiAgICAgICAgICAgIGxvY2FscyA9IFtpIGZvciBpIGluIHJlc3VsdDIgaWYgJzxFcGlzb2RlTnVtYmVyPicgaW4gaV0KCiAgICAgICAgICAgIHJlc3VsdCA9ICcnIDsgcmVzdWx0MiA9ICcnCgogICAgICAgICAgICBpZiBsaW1pdCA9PSAnJzoKICAgICAgICAgICAgICAgIGVwaXNvZGVzID0gW10KICAgICAgICAgICAgZWxpZiBsaW1pdCA9PSAnLTEnOgogICAgICAgICAgICAgICAgc2Vhc29ucyA9IFtdCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBlcGlzb2RlcyA9IFtpIGZvciBpIGluIGVwaXNvZGVzIGlmICc8U2Vhc29uTnVtYmVyPiUwMWQ8L1NlYXNvbk51bWJlcj4nICUgaW50KGxpbWl0KSBpbiBpXQogICAgICAgICAgICAgICAgc2Vhc29ucyA9IFtdCgoKICAgICAgICAgICAgdHJ5OiBwb3N0ZXIgPSBjbGllbnQucGFyc2VET00oaXRlbSwgJ3Bvc3RlcicpWzBdCiAgICAgICAgICAgIGV4Y2VwdDogcG9zdGVyID0gJycKICAgICAgICAgICAgaWYgbm90IHBvc3RlciA9PSAnJzogcG9zdGVyID0gc2VsZi50dmRiX2ltYWdlICsgcG9zdGVyCiAgICAgICAgICAgIGVsc2U6IHBvc3RlciA9ICcwJwogICAgICAgICAgICBwb3N0ZXIgPSBjbGllbnQucmVwbGFjZUhUTUxDb2Rlcyhwb3N0ZXIpCiAgICAgICAgICAgIHBvc3RlciA9IHBvc3Rlci5lbmNvZGUoJ3V0Zi04JykKCiAgICAgICAgICAgIHRyeTogYmFubmVyID0gY2xpZW50LnBhcnNlRE9NKGl0ZW0sICdiYW5uZXInKVswXQogICAgICAgICAgICBleGNlcHQ6IGJhbm5lciA9ICcnCiAgICAgICAgICAgIGlmIG5vdCBiYW5uZXIgPT0gJyc6IGJhbm5lciA9IHNlbGYudHZkYl9pbWFnZSArIGJhbm5lcgogICAgICAgICAgICBlbHNlOiBiYW5uZXIgPSAnMCcKICAgICAgICAgICAgYmFubmVyID0gY2xpZW50LnJlcGxhY2VIVE1MQ29kZXMoYmFubmVyKQogICAgICAgICAgICBiYW5uZXIgPSBiYW5uZXIuZW5jb2RlKCd1dGYtOCcpCgogICAgICAgICAgICB0cnk6IGZhbmFydCA9IGNsaWVudC5wYXJzZURPTShpdGVtLCAnZmFuYXJ0JylbMF0KICAgICAgICAgICAgZXhjZXB0OiBmYW5hcnQgPSAnJwogICAgICAgICAgICBpZiBub3QgZmFuYXJ0ID09ICcnOiBmYW5hcnQgPSBzZWxmLnR2ZGJfaW1hZ2UgKyBmYW5hcnQKICAgICAgICAgICAgZWxzZTogZmFuYXJ0ID0gJzAnCiAgICAgICAgICAgIGZhbmFydCA9IGNsaWVudC5yZXBsYWNlSFRNTENvZGVzKGZhbmFydCkKICAgICAgICAgICAgZmFuYXJ0ID0gZmFuYXJ0LmVuY29kZSgndXRmLTgnKQoKICAgICAgICAgICAgaWYgbm90IHBvc3RlciA9PSAnMCc6IHBhc3MKICAgICAgICAgICAgZWxpZiBub3QgZmFuYXJ0ID09ICcwJzogcG9zdGVyID0gZmFuYXJ0CiAgICAgICAgICAgIGVsaWYgbm90IGJhbm5lciA9PSAnMCc6IHBvc3RlciA9IGJhbm5lcgoKICAgICAgICAgICAgaWYgbm90IGJhbm5lciA9PSAnMCc6IHBhc3MKICAgICAgICAgICAgZWxpZiBub3QgZmFuYXJ0ID09ICcwJzogYmFubmVyID0gZmFuYXJ0CiAgICAgICAgICAgIGVsaWYgbm90IHBvc3RlciA9PSAnMCc6IGJhbm5lciA9IHBvc3RlcgoKICAgICAgICAgICAgdHJ5OiBzdGF0dXMgPSBjbGllbnQucGFyc2VET00oaXRlbSwgJ1N0YXR1cycpWzBdCiAgICAgICAgICAgIGV4Y2VwdDogc3RhdHVzID0gJycKICAgICAgICAgICAgaWYgc3RhdHVzID09ICcnOiBzdGF0dXMgPSAnRW5kZWQnCiAgICAgICAgICAgIHN0YXR1cyA9IGNsaWVudC5yZXBsYWNlSFRNTENvZGVzKHN0YXR1cykKICAgICAgICAgICAgc3RhdHVzID0gc3RhdHVzLmVuY29kZSgndXRmLTgnKQoKICAgICAgICAgICAgdHJ5OiBzdHVkaW8gPSBjbGllbnQucGFyc2VET00oaXRlbSwgJ05ldHdvcmsnKVswXQogICAgICAgICAgICBleGNlcHQ6IHN0dWRpbyA9ICcnCiAgICAgICAgICAgIGlmIHN0dWRpbyA9PSAnJzogc3R1ZGlvID0gJzAnCiAgICAgICAgICAgIHN0dWRpbyA9IGNsaWVudC5yZXBsYWNlSFRNTENvZGVzKHN0dWRpbykKICAgICAgICAgICAgc3R1ZGlvID0gc3R1ZGlvLmVuY29kZSgndXRmLTgnKQoKICAgICAgICAgICAgdHJ5OiBnZW5yZSA9IGNsaWVudC5wYXJzZURPTShpdGVtLCAnR2VucmUnKVswXQogICAgICAgICAgICBleGNlcHQ6IGdlbnJlID0gJycKICAgICAgICAgICAgZ2VucmUgPSBbeCBmb3IgeCBpbiBnZW5yZS5zcGxpdCgnfCcpIGlmIG5vdCB4ID09ICcnXQogICAgICAgICAgICBnZW5yZSA9ICcgLyAnLmpvaW4oZ2VucmUpCiAgICAgICAgICAgIGlmIGdlbnJlID09ICcnOiBnZW5yZSA9ICcwJwogICAgICAgICAgICBnZW5yZSA9IGNsaWVudC5yZXBsYWNlSFRNTENvZGVzKGdlbnJlKQogICAgICAgICAgICBnZW5yZSA9IGdlbnJlLmVuY29kZSgndXRmLTgnKQoKICAgICAgICAgICAgdHJ5OiBkdXJhdGlvbiA9IGNsaWVudC5wYXJzZURPTShpdGVtLCAnUnVudGltZScpWzBdCiAgICAgICAgICAgIGV4Y2VwdDogZHVyYXRpb24gPSAnJwogICAgICAgICAgICBpZiBkdXJhdGlvbiA9PSAnJzogZHVyYXRpb24gPSAnMCcKICAgICAgICAgICAgZHVyYXRpb24gPSBjbGllbnQucmVwbGFjZUhUTUxDb2RlcyhkdXJhdGlvbikKICAgICAgICAgICAgZHVyYXRpb24gPSBkdXJhdGlvbi5lbmNvZGUoJ3V0Zi04JykKCiAgICAgICAgICAgIHRyeTogcmF0aW5nID0gY2xpZW50LnBhcnNlRE9NKGl0ZW0sICdSYXRpbmcnKVswXQogICAgICAgICAgICBleGNlcHQ6IHJhdGluZyA9ICcnCiAgICAgICAgICAgIGlmIHJhdGluZyA9PSAnJzogcmF0aW5nID0gJzAnCiAgICAgICAgICAgIHJhdGluZyA9IGNsaWVudC5yZXBsYWNlSFRNTENvZGVzKHJhdGluZykKICAgICAgICAgICAgcmF0aW5nID0gcmF0aW5nLmVuY29kZSgndXRmLTgnKQoKICAgICAgICAgICAgdHJ5OiB2b3RlcyA9IGNsaWVudC5wYXJzZURPTShpdGVtLCAnUmF0aW5nQ291bnQnKVswXQogICAgICAgICAgICBleGNlcHQ6IHZvdGVzID0gJzAnCiAgICAgICAgICAgIGlmIHZvdGVzID09ICcnOiB2b3RlcyA9ICcwJwogICAgICAgICAgICB2b3RlcyA9IGNsaWVudC5yZXBsYWNlSFRNTENvZGVzKHZvdGVzKQogICAgICAgICAgICB2b3RlcyA9IHZvdGVzLmVuY29kZSgndXRmLTgnKQoKICAgICAgICAgICAgdHJ5OiBtcGFhID0gY2xpZW50LnBhcnNlRE9NKGl0ZW0sICdDb250ZW50UmF0aW5nJylbMF0KICAgICAgICAgICAgZXhjZXB0OiBtcGFhID0gJycKICAgICAgICAgICAgaWYgbXBhYSA9PSAnJzogbXBhYSA9ICcwJwogICAgICAgICAgICBtcGFhID0gY2xpZW50LnJlcGxhY2VIVE1MQ29kZXMobXBhYSkKICAgICAgICAgICAgbXBhYSA9IG1wYWEuZW5jb2RlKCd1dGYtOCcpCgogICAgICAgICAgICB0cnk6IGNhc3QgPSBjbGllbnQucGFyc2VET00oaXRlbSwgJ0FjdG9ycycpWzBdCiAgICAgICAgICAgIGV4Y2VwdDogY2FzdCA9ICcnCiAgICAgICAgICAgIGNhc3QgPSBbeCBmb3IgeCBpbiBjYXN0LnNwbGl0KCd8JykgaWYgbm90IHggPT0gJyddCiAgICAgICAgICAgIHRyeTogY2FzdCA9IFsoeC5lbmNvZGUoJ3V0Zi04JyksICcnKSBmb3IgeCBpbiBjYXN0XQogICAgICAgICAgICBleGNlcHQ6IGNhc3QgPSBbXQoKICAgICAgICAgICAgdHJ5OiBsYWJlbCA9IGNsaWVudC5wYXJzZURPTShpdGVtMiwgJ1Nlcmllc05hbWUnKVswXQogICAgICAgICAgICBleGNlcHQ6IGxhYmVsID0gJzAnCiAgICAgICAgICAgIGxhYmVsID0gY2xpZW50LnJlcGxhY2VIVE1MQ29kZXMobGFiZWwpCiAgICAgICAgICAgIGxhYmVsID0gbGFiZWwuZW5jb2RlKCd1dGYtOCcpCgogICAgICAgICAgICB0cnk6IHBsb3QgPSBjbGllbnQucGFyc2VET00oaXRlbTIsICdPdmVydmlldycpWzBdCiAgICAgICAgICAgIGV4Y2VwdDogcGxvdCA9ICcnCiAgICAgICAgICAgIGlmIHBsb3QgPT0gJyc6IHBsb3QgPSAnMCcKICAgICAgICAgICAgcGxvdCA9IGNsaWVudC5yZXBsYWNlSFRNTENvZGVzKHBsb3QpCiAgICAgICAgICAgIHBsb3QgPSBwbG90LmVuY29kZSgndXRmLTgnKQogICAgICAgICAgICAKICAgICAgICAgICAgdW5haXJlZCA9ICcnCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwYXNzCgoKICAgICAgICBmb3IgaXRlbSBpbiBzZWFzb25zOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBwcmVtaWVyZWQgPSBjbGllbnQucGFyc2VET00oaXRlbSwgJ0ZpcnN0QWlyZWQnKVswXQogICAgICAgICAgICAgICAgaWYgcHJlbWllcmVkID09ICcnIG9yICctMDAnIGluIHByZW1pZXJlZDogcHJlbWllcmVkID0gJzAnCiAgICAgICAgICAgICAgICBwcmVtaWVyZWQgPSBjbGllbnQucmVwbGFjZUhUTUxDb2RlcyhwcmVtaWVyZWQpCiAgICAgICAgICAgICAgICBwcmVtaWVyZWQgPSBwcmVtaWVyZWQuZW5jb2RlKCd1dGYtOCcpCgogICAgICAgICAgICAgICAgaWYgc3RhdHVzID09ICdFbmRlZCc6IHBhc3MKICAgICAgICAgICAgICAgIGVsaWYgcHJlbWllcmVkID09ICcwJzogcmFpc2UgRXhjZXB0aW9uKCkKICAgICAgICAgICAgICAgIGVsaWYgaW50KHJlLnN1YignW14wLTldJywgJycsIHN0cihwcmVtaWVyZWQpKSkgPiBpbnQocmUuc3ViKCdbXjAtOV0nLCAnJywgc3RyKHNlbGYudG9kYXlfZGF0ZSkpKToKICAgICAgICAgICAgICAgICAgICB1bmFpcmVkID0gJ3RydWUnCiAgICAgICAgICAgICAgICAgICAgaWYgc2VsZi5zaG93dW5haXJlZCAhPSAndHJ1ZSc6IHJhaXNlIEV4Y2VwdGlvbigpCgogICAgICAgICAgICAgICAgc2Vhc29uID0gY2xpZW50LnBhcnNlRE9NKGl0ZW0sICdTZWFzb25OdW1iZXInKVswXQogICAgICAgICAgICAgICAgc2Vhc29uID0gJyUwMWQnICUgaW50KHNlYXNvbikKICAgICAgICAgICAgICAgIHNlYXNvbiA9IHNlYXNvbi5lbmNvZGUoJ3V0Zi04JykKCiAgICAgICAgICAgICAgICB0aHVtYiA9IFtpIGZvciBpIGluIGFydHdvcmsgaWYgY2xpZW50LnBhcnNlRE9NKGksICdTZWFzb24nKVswXSA9PSBzZWFzb25dCiAgICAgICAgICAgICAgICB0cnk6IHRodW1iID0gY2xpZW50LnBhcnNlRE9NKHRodW1iWzBdLCAnQmFubmVyUGF0aCcpWzBdCiAgICAgICAgICAgICAgICBleGNlcHQ6IHRodW1iID0gJycKICAgICAgICAgICAgICAgIGlmIG5vdCB0aHVtYiA9PSAnJzogdGh1bWIgPSBzZWxmLnR2ZGJfaW1hZ2UgKyB0aHVtYgogICAgICAgICAgICAgICAgZWxzZTogdGh1bWIgPSAnMCcKICAgICAgICAgICAgICAgIHRodW1iID0gY2xpZW50LnJlcGxhY2VIVE1MQ29kZXModGh1bWIpCiAgICAgICAgICAgICAgICB0aHVtYiA9IHRodW1iLmVuY29kZSgndXRmLTgnKQoKICAgICAgICAgICAgICAgIGlmIHRodW1iID09ICcwJzogdGh1bWIgPSBwb3N0ZXIKCiAgICAgICAgICAgICAgICBzZWxmLmxpc3QuYXBwZW5kKHsnc2Vhc29uJzogc2Vhc29uLCAndHZzaG93dGl0bGUnOiB0dnNob3d0aXRsZSwgJ2xhYmVsJzogbGFiZWwsICd5ZWFyJzogeWVhciwgJ3ByZW1pZXJlZCc6IHByZW1pZXJlZCwgJ3N0YXR1cyc6IHN0YXR1cywgJ3N0dWRpbyc6IHN0dWRpbywgJ2dlbnJlJzogZ2VucmUsICdkdXJhdGlvbic6IGR1cmF0aW9uLCAncmF0aW5nJzogcmF0aW5nLCAndm90ZXMnOiB2b3RlcywgJ21wYWEnOiBtcGFhLCAnY2FzdCc6IGNhc3QsICdwbG90JzogcGxvdCwgJ2ltZGInOiBpbWRiLCAndHZkYic6IHR2ZGIsICdwb3N0ZXInOiBwb3N0ZXIsICdiYW5uZXInOiBiYW5uZXIsICdmYW5hcnQnOiBmYW5hcnQsICd0aHVtYic6IHRodW1iLCAndW5haXJlZCc6IHVuYWlyZWR9KQogICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICBwYXNzCgoKICAgICAgICBmb3IgaXRlbSBpbiBlcGlzb2RlczoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgcHJlbWllcmVkID0gY2xpZW50LnBhcnNlRE9NKGl0ZW0sICdGaXJzdEFpcmVkJylbMF0KICAgICAgICAgICAgICAgIGlmIHByZW1pZXJlZCA9PSAnJyBvciAnLTAwJyBpbiBwcmVtaWVyZWQ6IHByZW1pZXJlZCA9ICcwJwogICAgICAgICAgICAgICAgcHJlbWllcmVkID0gY2xpZW50LnJlcGxhY2VIVE1MQ29kZXMocHJlbWllcmVkKQogICAgICAgICAgICAgICAgcHJlbWllcmVkID0gcHJlbWllcmVkLmVuY29kZSgndXRmLTgnKQoKICAgICAgICAgICAgICAgIGlmIHN0YXR1cyA9PSAnRW5kZWQnOiBwYXNzCiAgICAgICAgICAgICAgICBlbGlmIHByZW1pZXJlZCA9PSAnMCc6IHJhaXNlIEV4Y2VwdGlvbigpCiAgICAgICAgICAgICAgICBlbGlmIGludChyZS5zdWIoJ1teMC05XScsICcnLCBzdHIocHJlbWllcmVkKSkpID4gaW50KHJlLnN1YignW14wLTldJywgJycsIHN0cihzZWxmLnRvZGF5X2RhdGUpKSk6CiAgICAgICAgICAgICAgICAgICAgdW5haXJlZCA9ICd0cnVlJwogICAgICAgICAgICAgICAgICAgIGlmIHNlbGYuc2hvd3VuYWlyZWQgIT0gJ3RydWUnOiByYWlzZSBFeGNlcHRpb24oKQoKICAgICAgICAgICAgICAgIHNlYXNvbiA9IGNsaWVudC5wYXJzZURPTShpdGVtLCAnU2Vhc29uTnVtYmVyJylbMF0KICAgICAgICAgICAgICAgIHNlYXNvbiA9ICclMDFkJyAlIGludChzZWFzb24pCiAgICAgICAgICAgICAgICBzZWFzb24gPSBzZWFzb24uZW5jb2RlKCd1dGYtOCcpCgogICAgICAgICAgICAgICAgZXBpc29kZSA9IGNsaWVudC5wYXJzZURPTShpdGVtLCAnRXBpc29kZU51bWJlcicpWzBdCiAgICAgICAgICAgICAgICBlcGlzb2RlID0gcmUuc3ViKCdbXjAtOV0nLCAnJywgJyUwMWQnICUgaW50KGVwaXNvZGUpKQogICAgICAgICAgICAgICAgZXBpc29kZSA9IGVwaXNvZGUuZW5jb2RlKCd1dGYtOCcpCgogICAgICAgICAgICAgICAgdGl0bGUgPSBjbGllbnQucGFyc2VET00oaXRlbSwgJ0VwaXNvZGVOYW1lJylbMF0KICAgICAgICAgICAgICAgIGlmIHRpdGxlID09ICcnOiB0aXRsZSA9ICcwJwogICAgICAgICAgICAgICAgdGl0bGUgPSBjbGllbnQucmVwbGFjZUhUTUxDb2Rlcyh0aXRsZSkKICAgICAgICAgICAgICAgIHRpdGxlID0gdGl0bGUuZW5jb2RlKCd1dGYtOCcpCgoKICAgICAgICAgICAgICAgIHRyeTogdGh1bWIgPSBjbGllbnQucGFyc2VET00oaXRlbSwgJ2ZpbGVuYW1lJylbMF0KICAgICAgICAgICAgICAgIGV4Y2VwdDogdGh1bWIgPSAnJwogICAgICAgICAgICAgICAgaWYgbm90IHRodW1iID09ICcnOiB0aHVtYiA9IHNlbGYudHZkYl9pbWFnZSArIHRodW1iCiAgICAgICAgICAgICAgICBlbHNlOiB0aHVtYiA9ICcwJwogICAgICAgICAgICAgICAgdGh1bWIgPSBjbGllbnQucmVwbGFjZUhUTUxDb2Rlcyh0aHVtYikKICAgICAgICAgICAgICAgIHRodW1iID0gdGh1bWIuZW5jb2RlKCd1dGYtOCcpCgogICAgICAgICAgICAgICAgaWYgbm90IHRodW1iID09ICcwJzogcGFzcwogICAgICAgICAgICAgICAgZWxpZiBub3QgZmFuYXJ0ID09ICcwJzogdGh1bWIgPSBmYW5hcnQucmVwbGFjZShzZWxmLnR2ZGJfaW1hZ2UsIHNlbGYudHZkYl9wb3N0ZXIpCiAgICAgICAgICAgICAgICBlbGlmIG5vdCBwb3N0ZXIgPT0gJzAnOiB0aHVtYiA9IHBvc3RlcgoKICAgICAgICAgICAgICAgIHRyeTogcmF0aW5nID0gY2xpZW50LnBhcnNlRE9NKGl0ZW0sICdSYXRpbmcnKVswXQogICAgICAgICAgICAgICAgZXhjZXB0OiByYXRpbmcgPSAnJwogICAgICAgICAgICAgICAgaWYgcmF0aW5nID09ICcnOiByYXRpbmcgPSAnMCcKICAgICAgICAgICAgICAgIHJhdGluZyA9IGNsaWVudC5yZXBsYWNlSFRNTENvZGVzKHJhdGluZykKICAgICAgICAgICAgICAgIHJhdGluZyA9IHJhdGluZy5lbmNvZGUoJ3V0Zi04JykKCiAgICAgICAgICAgICAgICB0cnk6IGRpcmVjdG9yID0gY2xpZW50LnBhcnNlRE9NKGl0ZW0sICdEaXJlY3RvcicpWzBdCiAgICAgICAgICAgICAgICBleGNlcHQ6IGRpcmVjdG9yID0gJycKICAgICAgICAgICAgICAgIGRpcmVjdG9yID0gW3ggZm9yIHggaW4gZGlyZWN0b3Iuc3BsaXQoJ3wnKSBpZiBub3QgeCA9PSAnJ10KICAgICAgICAgICAgICAgIGRpcmVjdG9yID0gJyAvICcuam9pbihkaXJlY3RvcikKICAgICAgICAgICAgICAgIGlmIGRpcmVjdG9yID09ICcnOiBkaXJlY3RvciA9ICcwJwogICAgICAgICAgICAgICAgZGlyZWN0b3IgPSBjbGllbnQucmVwbGFjZUhUTUxDb2RlcyhkaXJlY3RvcikKICAgICAgICAgICAgICAgIGRpcmVjdG9yID0gZGlyZWN0b3IuZW5jb2RlKCd1dGYtOCcpCgogICAgICAgICAgICAgICAgdHJ5OiB3cml0ZXIgPSBjbGllbnQucGFyc2VET00oaXRlbSwgJ1dyaXRlcicpWzBdCiAgICAgICAgICAgICAgICBleGNlcHQ6IHdyaXRlciA9ICcnCiAgICAgICAgICAgICAgICB3cml0ZXIgPSBbeCBmb3IgeCBpbiB3cml0ZXIuc3BsaXQoJ3wnKSBpZiBub3QgeCA9PSAnJ10KICAgICAgICAgICAgICAgIHdyaXRlciA9ICcgLyAnLmpvaW4od3JpdGVyKQogICAgICAgICAgICAgICAgaWYgd3JpdGVyID09ICcnOiB3cml0ZXIgPSAnMCcKICAgICAgICAgICAgICAgIHdyaXRlciA9IGNsaWVudC5yZXBsYWNlSFRNTENvZGVzKHdyaXRlcikKICAgICAgICAgICAgICAgIHdyaXRlciA9IHdyaXRlci5lbmNvZGUoJ3V0Zi04JykKCiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgbG9jYWwgPSBjbGllbnQucGFyc2VET00oaXRlbSwgJ2lkJylbMF0KICAgICAgICAgICAgICAgICAgICBsb2NhbCA9IFt4IGZvciB4IGluIGxvY2FscyBpZiAnPGlkPiVzPC9pZD4nICUgc3RyKGxvY2FsKSBpbiB4XVswXQogICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgIGxvY2FsID0gaXRlbQoKICAgICAgICAgICAgICAgIGxhYmVsID0gY2xpZW50LnBhcnNlRE9NKGxvY2FsLCAnRXBpc29kZU5hbWUnKVswXQogICAgICAgICAgICAgICAgaWYgbGFiZWwgPT0gJyc6IGxhYmVsID0gJzAnCiAgICAgICAgICAgICAgICBsYWJlbCA9IGNsaWVudC5yZXBsYWNlSFRNTENvZGVzKGxhYmVsKQogICAgICAgICAgICAgICAgbGFiZWwgPSBsYWJlbC5lbmNvZGUoJ3V0Zi04JykKCiAgICAgICAgICAgICAgICB0cnk6IGVwaXNvZGVwbG90ID0gY2xpZW50LnBhcnNlRE9NKGxvY2FsLCAnT3ZlcnZpZXcnKVswXQogICAgICAgICAgICAgICAgZXhjZXB0OiBlcGlzb2RlcGxvdCA9ICcnCiAgICAgICAgICAgICAgICBpZiBlcGlzb2RlcGxvdCA9PSAnJzogZXBpc29kZXBsb3QgPSAnMCcKICAgICAgICAgICAgICAgIGlmIGVwaXNvZGVwbG90ID09ICcwJzogZXBpc29kZXBsb3QgPSBwbG90CiAgICAgICAgICAgICAgICBlcGlzb2RlcGxvdCA9IGNsaWVudC5yZXBsYWNlSFRNTENvZGVzKGVwaXNvZGVwbG90KQogICAgICAgICAgICAgICAgdHJ5OiBlcGlzb2RlcGxvdCA9IGVwaXNvZGVwbG90LmVuY29kZSgndXRmLTgnKQogICAgICAgICAgICAgICAgZXhjZXB0OiBwYXNzCgogICAgICAgICAgICAgICAgc2VsZi5saXN0LmFwcGVuZCh7J3RpdGxlJzogdGl0bGUsICdsYWJlbCc6IGxhYmVsLCAnc2Vhc29uJzogc2Vhc29uLCAnZXBpc29kZSc6IGVwaXNvZGUsICd0dnNob3d0aXRsZSc6IHR2c2hvd3RpdGxlLCAneWVhcic6IHllYXIsICdwcmVtaWVyZWQnOiBwcmVtaWVyZWQsICdzdGF0dXMnOiBzdGF0dXMsICdzdHVkaW8nOiBzdHVkaW8sICdnZW5yZSc6IGdlbnJlLCAnZHVyYXRpb24nOiBkdXJhdGlvbiwgJ3JhdGluZyc6IHJhdGluZywgJ3ZvdGVzJzogdm90ZXMsICdtcGFhJzogbXBhYSwgJ2RpcmVjdG9yJzogZGlyZWN0b3IsICd3cml0ZXInOiB3cml0ZXIsICdjYXN0JzogY2FzdCwgJ3Bsb3QnOiBlcGlzb2RlcGxvdCwgJ2ltZGInOiBpbWRiLCAndHZkYic6IHR2ZGIsICdwb3N0ZXInOiBwb3N0ZXIsICdiYW5uZXInOiBiYW5uZXIsICdmYW5hcnQnOiBmYW5hcnQsICd0aHVtYic6IHRodW1iLCAndW5haXJlZCc6IHVuYWlyZWR9KQogICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICBwYXNzCgogICAgICAgIHJldHVybiBzZWxmLmxpc3QKCgogICAgZGVmIHNlYXNvbkRpcmVjdG9yeShzZWxmLCBpdGVtcyk6CiAgICAgICAgaWYgaXRlbXMgPT0gTm9uZSBvciBsZW4oaXRlbXMpID09IDA6IGNvbnRyb2wuaWRsZSgpIDsgc3lzLmV4aXQoKQoKICAgICAgICBzeXNhZGRvbiA9IHN5cy5hcmd2WzBdCgogICAgICAgIHN5c2hhbmRsZSA9IGludChzeXMuYXJndlsxXSkKCiAgICAgICAgYWRkb25Qb3N0ZXIsIGFkZG9uQmFubmVyID0gY29udHJvbC5hZGRvblBvc3RlcigpLCBjb250cm9sLmFkZG9uQmFubmVyKCkKCiAgICAgICAgYWRkb25GYW5hcnQsIHNldHRpbmdGYW5hcnQgPSBjb250cm9sLmFkZG9uRmFuYXJ0KCksIGNvbnRyb2wuc2V0dGluZygnZmFuYXJ0JykKCiAgICAgICAgdHJha3RDcmVkZW50aWFscyA9IHRyYWt0LmdldFRyYWt0Q3JlZGVudGlhbHNJbmZvKCkKCiAgICAgICAgdHJ5OiBpc09sZCA9IEZhbHNlIDsgY29udHJvbC5pdGVtKCkuZ2V0QXJ0KCd0eXBlJykKICAgICAgICBleGNlcHQ6IGlzT2xkID0gVHJ1ZQoKICAgICAgICB0cnk6IGluZGljYXRvcnMgPSBwbGF5Y291bnQuZ2V0U2Vhc29uSW5kaWNhdG9ycyhpdGVtc1swXVsnaW1kYiddKQogICAgICAgIGV4Y2VwdDogcGFzcwoKICAgICAgICB3YXRjaGVkTWVudSA9IGNvbnRyb2wubGFuZygzMjA2OCkuZW5jb2RlKCd1dGYtOCcpIGlmIHRyYWt0LmdldFRyYWt0SW5kaWNhdG9yc0luZm8oKSA9PSBUcnVlIGVsc2UgY29udHJvbC5sYW5nKDMyMDY2KS5lbmNvZGUoJ3V0Zi04JykKCiAgICAgICAgdW53YXRjaGVkTWVudSA9IGNvbnRyb2wubGFuZygzMjA2OSkuZW5jb2RlKCd1dGYtOCcpIGlmIHRyYWt0LmdldFRyYWt0SW5kaWNhdG9yc0luZm8oKSA9PSBUcnVlIGVsc2UgY29udHJvbC5sYW5nKDMyMDY3KS5lbmNvZGUoJ3V0Zi04JykKCiAgICAgICAgcXVldWVNZW51ID0gY29udHJvbC5sYW5nKDMyMDY1KS5lbmNvZGUoJ3V0Zi04JykKCiAgICAgICAgdHJha3RNYW5hZ2VyTWVudSA9IGNvbnRyb2wubGFuZygzMjA3MCkuZW5jb2RlKCd1dGYtOCcpCgogICAgICAgIGxhYmVsTWVudSA9IGNvbnRyb2wubGFuZygzMjA1NSkuZW5jb2RlKCd1dGYtOCcpCgogICAgICAgIHBsYXlSYW5kb20gPSBjb250cm9sLmxhbmcoMzI1MzUpLmVuY29kZSgndXRmLTgnKQoKICAgICAgICBhZGRUb0xpYnJhcnkgPSBjb250cm9sLmxhbmcoMzI1NTEpLmVuY29kZSgndXRmLTgnKQoKCiAgICAgICAgZm9yIGkgaW4gaXRlbXM6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGxhYmVsID0gJyVzICVzJyAlIChsYWJlbE1lbnUsIGlbJ3NlYXNvbiddKQogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIGlmIGlbJ3VuYWlyZWQnXSA9PSAndHJ1ZSc6CiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsID0gJ1tDT0xPUiBkYXJrcmVkXVtJXSVzWy9JXVsvQ09MT1JdJyAlIGxhYmVsCiAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICAgICAgc3lzdGl0bGUgPSBzeXNuYW1lID0gdXJsbGliLnF1b3RlX3BsdXMoaVsndHZzaG93dGl0bGUnXSkKCiAgICAgICAgICAgICAgICBpbWRiLCB0dmRiLCB5ZWFyLCBzZWFzb24gPSBpWydpbWRiJ10sIGlbJ3R2ZGInXSwgaVsneWVhciddLCBpWydzZWFzb24nXQoKICAgICAgICAgICAgICAgIG1ldGEgPSBkaWN0KChrLHYpIGZvciBrLCB2IGluIGkuaXRlcml0ZW1zKCkgaWYgbm90IHYgPT0gJzAnKQogICAgICAgICAgICAgICAgbWV0YS51cGRhdGUoeydjb2RlJzogaW1kYiwgJ2ltZGJudW1iZXInOiBpbWRiLCAnaW1kYl9pZCc6IGltZGJ9KQogICAgICAgICAgICAgICAgbWV0YS51cGRhdGUoeyd0dmRiX2lkJzogdHZkYn0pCiAgICAgICAgICAgICAgICBtZXRhLnVwZGF0ZSh7J21lZGlhdHlwZSc6ICd0dnNob3cnfSkKICAgICAgICAgICAgICAgIG1ldGEudXBkYXRlKHsndHJhaWxlcic6ICclcz9hY3Rpb249dHJhaWxlciZuYW1lPSVzJyAlIChzeXNhZGRvbiwgc3lzbmFtZSl9KQogICAgICAgICAgICAgICAgaWYgbm90ICdkdXJhdGlvbicgaW4gaTogbWV0YS51cGRhdGUoeydkdXJhdGlvbic6ICc2MCd9KQogICAgICAgICAgICAgICAgZWxpZiBpWydkdXJhdGlvbiddID09ICcwJzogbWV0YS51cGRhdGUoeydkdXJhdGlvbic6ICc2MCd9KQogICAgICAgICAgICAgICAgdHJ5OiBtZXRhLnVwZGF0ZSh7J2R1cmF0aW9uJzogc3RyKGludChtZXRhWydkdXJhdGlvbiddKSAqIDYwKX0pCiAgICAgICAgICAgICAgICBleGNlcHQ6IHBhc3MKICAgICAgICAgICAgICAgIHRyeTogbWV0YS51cGRhdGUoeydnZW5yZSc6IGNsZWFuZ2VucmUubGFuZyhtZXRhWydnZW5yZSddLCBzZWxmLmxhbmcpfSkKICAgICAgICAgICAgICAgIGV4Y2VwdDogcGFzcwogICAgICAgICAgICAgICAgdHJ5OiBtZXRhLnVwZGF0ZSh7J3R2c2hvd3RpdGxlJzogaVsnbGFiZWwnXX0pCiAgICAgICAgICAgICAgICBleGNlcHQ6IHBhc3MKCiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgaWYgc2Vhc29uIGluIGluZGljYXRvcnM6IG1ldGEudXBkYXRlKHsncGxheWNvdW50JzogMSwgJ292ZXJsYXknOiA3fSkKICAgICAgICAgICAgICAgICAgICBlbHNlOiBtZXRhLnVwZGF0ZSh7J3BsYXljb3VudCc6IDAsICdvdmVybGF5JzogNn0pCiAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgcGFzcwoKCiAgICAgICAgICAgICAgICB1cmwgPSAnJXM/YWN0aW9uPWVwaXNvZGVzJnR2c2hvd3RpdGxlPSVzJnllYXI9JXMmaW1kYj0lcyZ0dmRiPSVzJnNlYXNvbj0lcycgJSAoc3lzYWRkb24sIHN5c3RpdGxlLCB5ZWFyLCBpbWRiLCB0dmRiLCBzZWFzb24pCgoKICAgICAgICAgICAgICAgIGNtID0gW10KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgY20uYXBwZW5kKChwbGF5UmFuZG9tLCAnUnVuUGx1Z2luKCVzP2FjdGlvbj1yYW5kb20mcnR5cGU9ZXBpc29kZSZ0dnNob3d0aXRsZT0lcyZ5ZWFyPSVzJmltZGI9JXMmdHZkYj0lcyZzZWFzb249JXMpJyAlIChzeXNhZGRvbiwgdXJsbGliLnF1b3RlX3BsdXMoc3lzdGl0bGUpLCB1cmxsaWIucXVvdGVfcGx1cyh5ZWFyKSwgdXJsbGliLnF1b3RlX3BsdXMoaW1kYiksIHVybGxpYi5xdW90ZV9wbHVzKHR2ZGIpLCB1cmxsaWIucXVvdGVfcGx1cyhzZWFzb24pKSkpCgogICAgICAgICAgICAgICAgY20uYXBwZW5kKChxdWV1ZU1lbnUsICdSdW5QbHVnaW4oJXM/YWN0aW9uPXF1ZXVlSXRlbSknICUgc3lzYWRkb24pKQoKICAgICAgICAgICAgICAgIGNtLmFwcGVuZCgod2F0Y2hlZE1lbnUsICdSdW5QbHVnaW4oJXM/YWN0aW9uPXR2UGxheWNvdW50Jm5hbWU9JXMmaW1kYj0lcyZ0dmRiPSVzJnNlYXNvbj0lcyZxdWVyeT03KScgJSAoc3lzYWRkb24sIHN5c3RpdGxlLCBpbWRiLCB0dmRiLCBzZWFzb24pKSkKCiAgICAgICAgICAgICAgICBjbS5hcHBlbmQoKHVud2F0Y2hlZE1lbnUsICdSdW5QbHVnaW4oJXM/YWN0aW9uPXR2UGxheWNvdW50Jm5hbWU9JXMmaW1kYj0lcyZ0dmRiPSVzJnNlYXNvbj0lcyZxdWVyeT02KScgJSAoc3lzYWRkb24sIHN5c3RpdGxlLCBpbWRiLCB0dmRiLCBzZWFzb24pKSkKCiAgICAgICAgICAgICAgICBpZiB0cmFrdENyZWRlbnRpYWxzID09IFRydWU6CiAgICAgICAgICAgICAgICAgICAgY20uYXBwZW5kKCh0cmFrdE1hbmFnZXJNZW51LCAnUnVuUGx1Z2luKCVzP2FjdGlvbj10cmFrdE1hbmFnZXImbmFtZT0lcyZ0dmRiPSVzJmNvbnRlbnQ9dHZzaG93KScgJSAoc3lzYWRkb24sIHN5c25hbWUsIHR2ZGIpKSkKCiAgICAgICAgICAgICAgICBpZiBpc09sZCA9PSBUcnVlOgogICAgICAgICAgICAgICAgICAgIGNtLmFwcGVuZCgoY29udHJvbC5sYW5nMigxOTAzMykuZW5jb2RlKCd1dGYtOCcpLCAnQWN0aW9uKEluZm8pJykpCgogICAgICAgICAgICAgICAgY20uYXBwZW5kKChhZGRUb0xpYnJhcnksICdSdW5QbHVnaW4oJXM/YWN0aW9uPXR2c2hvd1RvTGlicmFyeSZ0dnNob3d0aXRsZT0lcyZ5ZWFyPSVzJmltZGI9JXMmdHZkYj0lcyknICUgKHN5c2FkZG9uLCBzeXN0aXRsZSwgeWVhciwgaW1kYiwgdHZkYikpKQoKICAgICAgICAgICAgICAgIGl0ZW0gPSBjb250cm9sLml0ZW0obGFiZWw9bGFiZWwpCgogICAgICAgICAgICAgICAgYXJ0ID0ge30KCiAgICAgICAgICAgICAgICBpZiAndGh1bWInIGluIGkgYW5kIG5vdCBpWyd0aHVtYiddID09ICcwJzoKICAgICAgICAgICAgICAgICAgICBhcnQudXBkYXRlKHsnaWNvbic6IGlbJ3RodW1iJ10sICd0aHVtYic6IGlbJ3RodW1iJ10sICdwb3N0ZXInOiBpWyd0aHVtYiddfSkKICAgICAgICAgICAgICAgIGVsaWYgJ3Bvc3RlcicgaW4gaSBhbmQgbm90IGlbJ3Bvc3RlciddID09ICcwJzoKICAgICAgICAgICAgICAgICAgICBhcnQudXBkYXRlKHsnaWNvbic6IGlbJ3Bvc3RlciddLCAndGh1bWInOiBpWydwb3N0ZXInXSwgJ3Bvc3Rlcic6IGlbJ3Bvc3RlciddfSkKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgYXJ0LnVwZGF0ZSh7J2ljb24nOiBhZGRvblBvc3RlciwgJ3RodW1iJzogYWRkb25Qb3N0ZXIsICdwb3N0ZXInOiBhZGRvblBvc3Rlcn0pCgogICAgICAgICAgICAgICAgaWYgJ2Jhbm5lcicgaW4gaSBhbmQgbm90IGlbJ2Jhbm5lciddID09ICcwJzoKICAgICAgICAgICAgICAgICAgICBhcnQudXBkYXRlKHsnYmFubmVyJzogaVsnYmFubmVyJ119KQogICAgICAgICAgICAgICAgZWxpZiAnZmFuYXJ0JyBpbiBpIGFuZCBub3QgaVsnZmFuYXJ0J10gPT0gJzAnOgogICAgICAgICAgICAgICAgICAgIGFydC51cGRhdGUoeydiYW5uZXInOiBpWydmYW5hcnQnXX0pCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIGFydC51cGRhdGUoeydiYW5uZXInOiBhZGRvbkJhbm5lcn0pCgogICAgICAgICAgICAgICAgaWYgc2V0dGluZ0ZhbmFydCA9PSAndHJ1ZScgYW5kICdmYW5hcnQnIGluIGkgYW5kIG5vdCBpWydmYW5hcnQnXSA9PSAnMCc6CiAgICAgICAgICAgICAgICAgICAgaXRlbS5zZXRQcm9wZXJ0eSgnRmFuYXJ0X0ltYWdlJywgaVsnZmFuYXJ0J10pCiAgICAgICAgICAgICAgICBlbGlmIG5vdCBhZGRvbkZhbmFydCA9PSBOb25lOgogICAgICAgICAgICAgICAgICAgIGl0ZW0uc2V0UHJvcGVydHkoJ0ZhbmFydF9JbWFnZScsIGFkZG9uRmFuYXJ0KQoKICAgICAgICAgICAgICAgIGl0ZW0uc2V0QXJ0KGFydCkKICAgICAgICAgICAgICAgIGl0ZW0uYWRkQ29udGV4dE1lbnVJdGVtcyhjbSkKICAgICAgICAgICAgICAgIGl0ZW0uc2V0SW5mbyh0eXBlPSdWaWRlbycsIGluZm9MYWJlbHMgPSBtZXRhKQoKICAgICAgICAgICAgICAgIHZpZGVvX3N0cmVhbWluZm8gPSB7J2NvZGVjJzogJ2gyNjQnfQogICAgICAgICAgICAgICAgaXRlbS5hZGRTdHJlYW1JbmZvKCd2aWRlbycsIHZpZGVvX3N0cmVhbWluZm8pCgogICAgICAgICAgICAgICAgY29udHJvbC5hZGRJdGVtKGhhbmRsZT1zeXNoYW5kbGUsIHVybD11cmwsIGxpc3RpdGVtPWl0ZW0sIGlzRm9sZGVyPVRydWUpCiAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgdHJ5OiBjb250cm9sLnByb3BlcnR5KHN5c2hhbmRsZSwgJ3Nob3dwbG90JywgaXRlbXNbMF1bJ3Bsb3QnXSkKICAgICAgICBleGNlcHQ6IHBhc3MKCiAgICAgICAgY29udHJvbC5jb250ZW50KHN5c2hhbmRsZSwgJ3NlYXNvbnMnKQogICAgICAgIGNvbnRyb2wuZGlyZWN0b3J5KHN5c2hhbmRsZSwgY2FjaGVUb0Rpc2M9VHJ1ZSkKICAgICAgICB2aWV3cy5zZXRWaWV3KCdzZWFzb25zJywgeydza2luLmVzdHVhcnknOiA1NSwgJ3NraW4uY29uZmx1ZW5jZSc6IDUwMH0pCgoKY2xhc3MgZXBpc29kZXM6CiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgc2VsZi5saXN0ID0gW10KCiAgICAgICAgc2VsZi50cmFrdF9saW5rID0gJ2h0dHA6Ly9hcGkudHJha3QudHYnCiAgICAgICAgc2VsZi50dm1hemVfbGluayA9ICdodHRwOi8vYXBpLnR2bWF6ZS5jb20nCiAgICAgICAgc2VsZi50dmRiX2tleSA9ICdNVVEyTWtZeVJqa3dNRE13UXpRME5BPT0nCiAgICAgICAgc2VsZi5kYXRldGltZSA9IChkYXRldGltZS5kYXRldGltZS51dGNub3coKSAtIGRhdGV0aW1lLnRpbWVkZWx0YShob3VycyA9IDUpKQogICAgICAgIHNlbGYuc3lzdGltZSA9IChzZWxmLmRhdGV0aW1lKS5zdHJmdGltZSgnJVklbSVkJUglTSVTJWYnKQogICAgICAgIHNlbGYudG9kYXlfZGF0ZSA9IChzZWxmLmRhdGV0aW1lKS5zdHJmdGltZSgnJVktJW0tJWQnKQogICAgICAgIHNlbGYudHJha3RfdXNlciA9IGNvbnRyb2wuc2V0dGluZygndHJha3QudXNlcicpLnN0cmlwKCkKICAgICAgICBzZWxmLmxhbmcgPSBjb250cm9sLmFwaUxhbmd1YWdlKClbJ3R2ZGInXQogICAgICAgIHNlbGYuc2hvd3VuYWlyZWQgPSBjb250cm9sLnNldHRpbmcoJ3Nob3d1bmFpcmVkJykgb3IgJ3RydWUnCgogICAgICAgIHNlbGYudHZkYl9pbmZvX2xpbmsgPSAnaHR0cDovL3RoZXR2ZGIuY29tL2FwaS8lcy9zZXJpZXMvJXMvYWxsLyVzLnppcCcgJSAoc2VsZi50dmRiX2tleS5kZWNvZGUoJ2Jhc2U2NCcpLCAnJXMnLCAnJXMnKQogICAgICAgIHNlbGYudHZkYl9pbWFnZSA9ICdodHRwOi8vdGhldHZkYi5jb20vYmFubmVycy8nCiAgICAgICAgc2VsZi50dmRiX3Bvc3RlciA9ICdodHRwOi8vdGhldHZkYi5jb20vYmFubmVycy9fY2FjaGUvJwoKICAgICAgICBzZWxmLmFkZGVkX2xpbmsgPSAnaHR0cDovL2FwaS50dm1hemUuY29tL3NjaGVkdWxlJwogICAgICAgICNodHRwczovL2FwaS50cmFrdC50di9jYWxlbmRhcnMvYWxsL3Nob3dzL2RhdGVbMzBdLzMxICN1c2UgdGhpcyBmb3IgbmV3IGVwaXNvZGVzPwogICAgICAgICNzZWxmLm15Y2FsZW5kYXJfbGluayA9ICdodHRwOi8vYXBpLnRyYWt0LnR2L2NhbGVuZGFycy9teS9zaG93cy9kYXRlWzI5XS82MC8nCiAgICAgICAgc2VsZi5teWNhbGVuZGFyX2xpbmsgPSAnaHR0cDovL2FwaS50cmFrdC50di9jYWxlbmRhcnMvbXkvc2hvd3MvZGF0ZVszMF0vMzEvJyAjZ28gYmFjayAzMCBhbmQgc2hvdyBhbGwgc2hvd3MgYWlyZWQgdW50aWwgdG9tb3Jyb3cKICAgICAgICBzZWxmLnRyYWt0aGlzdG9yeV9saW5rID0gJ2h0dHA6Ly9hcGkudHJha3QudHYvdXNlcnMvbWUvaGlzdG9yeS9zaG93cz9saW1pdD0zMDAnCiAgICAgICAgc2VsZi5wcm9ncmVzc19saW5rID0gJ2h0dHA6Ly9hcGkudHJha3QudHYvdXNlcnMvbWUvd2F0Y2hlZC9zaG93cycKICAgICAgICBzZWxmLmhpZGRlbnByb2dyZXNzX2xpbmsgPSAnaHR0cDovL2FwaS50cmFrdC50di91c2Vycy9oaWRkZW4vcHJvZ3Jlc3Nfd2F0Y2hlZD9saW1pdD0xMDAwJnR5cGU9c2hvdycKICAgICAgICBzZWxmLmNhbGVuZGFyX2xpbmsgPSAnaHR0cDovL2FwaS50dm1hemUuY29tL3NjaGVkdWxlP2RhdGU9JXMnCiAgICAgICAgc2VsZi5vbkRlY2tfbGluayA9ICdodHRwOi8vYXBpLnRyYWt0LnR2L3N5bmMvcGxheWJhY2svZXBpc29kZXM/ZXh0ZW5kZWQ9ZnVsbCZsaW1pdD0xMCcKICAgICAgICBzZWxmLnRyYWt0bGlzdHNfbGluayA9ICdodHRwOi8vYXBpLnRyYWt0LnR2L3VzZXJzL21lL2xpc3RzJwogICAgICAgIHNlbGYudHJha3RsaWtlZGxpc3RzX2xpbmsgPSAnaHR0cDovL2FwaS50cmFrdC50di91c2Vycy9saWtlcy9saXN0cz9saW1pdD0xMDAwMDAwJwogICAgICAgIHNlbGYudHJha3RsaXN0X2xpbmsgPSAnaHR0cDovL2FwaS50cmFrdC50di91c2Vycy8lcy9saXN0cy8lcy9pdGVtcycKCgogICAgZGVmIGdldChzZWxmLCB0dnNob3d0aXRsZSwgeWVhciwgaW1kYiwgdHZkYiwgc2Vhc29uPU5vbmUsIGVwaXNvZGU9Tm9uZSwgaWR4PVRydWUsIGNyZWF0ZV9kaXJlY3Rvcnk9VHJ1ZSk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBpZiBpZHggPT0gVHJ1ZToKICAgICAgICAgICAgICAgIGlmIHNlYXNvbiA9PSBOb25lIGFuZCBlcGlzb2RlID09IE5vbmU6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5saXN0ID0gY2FjaGUuZ2V0KHNlYXNvbnMoKS50dmRiX2xpc3QsIDEsIHR2c2hvd3RpdGxlLCB5ZWFyLCBpbWRiLCB0dmRiLCBzZWxmLmxhbmcsICctMScpCiAgICAgICAgICAgICAgICBlbGlmIGVwaXNvZGUgPT0gTm9uZToKICAgICAgICAgICAgICAgICAgICBzZWxmLmxpc3QgPSBjYWNoZS5nZXQoc2Vhc29ucygpLnR2ZGJfbGlzdCwgMSwgdHZzaG93dGl0bGUsIHllYXIsIGltZGIsIHR2ZGIsIHNlbGYubGFuZywgc2Vhc29uKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBzZWxmLmxpc3QgPSBjYWNoZS5nZXQoc2Vhc29ucygpLnR2ZGJfbGlzdCwgMSwgdHZzaG93dGl0bGUsIHllYXIsIGltZGIsIHR2ZGIsIHNlbGYubGFuZywgJy0xJykKICAgICAgICAgICAgICAgICAgICBudW0gPSBbeCBmb3IgeCx5IGluIGVudW1lcmF0ZShzZWxmLmxpc3QpIGlmIHlbJ3NlYXNvbiddID09IHN0cihzZWFzb24pIGFuZCAgeVsnZXBpc29kZSddID09IHN0cihlcGlzb2RlKV1bLTFdCiAgICAgICAgICAgICAgICAgICAgc2VsZi5saXN0ID0gW3kgZm9yIHgseSBpbiBlbnVtZXJhdGUoc2VsZi5saXN0KSBpZiB4ID49IG51bV0KCiAgICAgICAgICAgICAgICBpZiBjcmVhdGVfZGlyZWN0b3J5ID09IFRydWU6IHNlbGYuZXBpc29kZURpcmVjdG9yeShzZWxmLmxpc3QpCiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5saXN0CiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLmxpc3QgPSBzZWFzb25zKCkudHZkYl9saXN0KHR2c2hvd3RpdGxlLCB5ZWFyLCBpbWRiLCB0dmRiLCAnZW4nLCAnLTEnKQogICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYubGlzdAogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcGFzcwoKCiAgICBkZWYgY2FsZW5kYXIoc2VsZiwgdXJsKToKICAgICAgICB0cnk6CgogICAgICAgICAgICB0cnk6IHVybCA9IGdldGF0dHIoc2VsZiwgdXJsICsgJ19saW5rJykKICAgICAgICAgICAgZXhjZXB0OiBwYXNzCgogICAgICAgICAgICBpZiBzZWxmLnRyYWt0X2xpbmsgaW4gdXJsIGFuZCB1cmwgPT0gc2VsZi5vbkRlY2tfbGluazoKICAgICAgICAgICAgICAgIHNlbGYuYmxpc3QgPSBjYWNoZS5nZXQoc2VsZi50cmFrdF9lcGlzb2Rlc19saXN0LCA3MjAsIHVybCwgc2VsZi50cmFrdF91c2VyLCBzZWxmLmxhbmcpCiAgICAgICAgICAgICAgICBzZWxmLmxpc3QgPSBbXQogICAgICAgICAgICAgICAgc2VsZi5saXN0ID0gY2FjaGUuZ2V0KHNlbGYudHJha3RfZXBpc29kZXNfbGlzdCwgMCwgdXJsLCBzZWxmLnRyYWt0X3VzZXIsIHNlbGYubGFuZykKICAgICAgICAgICAgICAgIHNlbGYubGlzdCA9IHNlbGYubGlzdFs6Oi0xXQoKICAgICAgICAgICAgZWxpZiBzZWxmLnRyYWt0X2xpbmsgaW4gdXJsIGFuZCB1cmwgPT0gc2VsZi5wcm9ncmVzc19saW5rOgogICAgICAgICAgICAgICAgc2VsZi5ibGlzdCA9IGNhY2hlLmdldChzZWxmLnRyYWt0X3Byb2dyZXNzX2xpc3QsIDcyMCwgdXJsLCBzZWxmLnRyYWt0X3VzZXIsIHNlbGYubGFuZykKICAgICAgICAgICAgICAgIHNlbGYubGlzdCA9IFtdCiAgICAgICAgICAgICAgICBzZWxmLmxpc3QgPSBjYWNoZS5nZXQoc2VsZi50cmFrdF9wcm9ncmVzc19saXN0LCAwLCB1cmwsIHNlbGYudHJha3RfdXNlciwgc2VsZi5sYW5nKQoKICAgICAgICAgICAgZWxpZiBzZWxmLnRyYWt0X2xpbmsgaW4gdXJsIGFuZCB1cmwgPT0gc2VsZi5teWNhbGVuZGFyX2xpbms6CiAgICAgICAgICAgICAgICBzZWxmLmJsaXN0ID0gY2FjaGUuZ2V0KHNlbGYudHJha3RfZXBpc29kZXNfbGlzdCwgNzIwLCB1cmwsIHNlbGYudHJha3RfdXNlciwgc2VsZi5sYW5nKQogICAgICAgICAgICAgICAgc2VsZi5saXN0ID0gW10KICAgICAgICAgICAgICAgIHNlbGYubGlzdCA9IGNhY2hlLmdldChzZWxmLnRyYWt0X2VwaXNvZGVzX2xpc3QsIDAsIHVybCwgc2VsZi50cmFrdF91c2VyLCBzZWxmLmxhbmcpCgogICAgICAgICAgICBlbGlmIHNlbGYudHJha3RfbGluayBpbiB1cmwgYW5kICcvdXNlcnMvJyBpbiB1cmw6CiAgICAgICAgICAgICAgICBzZWxmLmxpc3QgPSBjYWNoZS5nZXQoc2VsZi50cmFrdF9saXN0LCAwLCB1cmwsIHNlbGYudHJha3RfdXNlcikKICAgICAgICAgICAgICAgIHNlbGYubGlzdCA9IHNlbGYubGlzdFs6Oi0xXQoKICAgICAgICAgICAgZWxpZiBzZWxmLnRyYWt0X2xpbmsgaW4gdXJsOgogICAgICAgICAgICAgICAgc2VsZi5saXN0ID0gY2FjaGUuZ2V0KHNlbGYudHJha3RfbGlzdCwgMSwgdXJsLCBzZWxmLnRyYWt0X3VzZXIpCgoKICAgICAgICAgICAgZWxpZiBzZWxmLnR2bWF6ZV9saW5rIGluIHVybCBhbmQgdXJsID09IHNlbGYuYWRkZWRfbGluazoKICAgICAgICAgICAgICAgIHVybHMgPSBbaVsndXJsJ10gZm9yIGkgaW4gc2VsZi5jYWxlbmRhcnMoaWR4PUZhbHNlKV1bOjVdCiAgICAgICAgICAgICAgICBzZWxmLmxpc3QgPSBbXQogICAgICAgICAgICAgICAgZm9yIHVybCBpbiB1cmxzOgogICAgICAgICAgICAgICAgICAgIHNlbGYubGlzdCArPSBjYWNoZS5nZXQoc2VsZi50dm1hemVfbGlzdCwgNzIwLCB1cmwsIFRydWUpCgogICAgICAgICAgICBlbGlmIHNlbGYudHZtYXplX2xpbmsgaW4gdXJsOgogICAgICAgICAgICAgICAgc2VsZi5saXN0ID0gY2FjaGUuZ2V0KHNlbGYudHZtYXplX2xpc3QsIDEsIHVybCwgRmFsc2UpCgoKICAgICAgICAgICAgc2VsZi5lcGlzb2RlRGlyZWN0b3J5KHNlbGYubGlzdCkKICAgICAgICAgICAgcmV0dXJuIHNlbGYubGlzdAogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcGFzcwoKCiAgICBkZWYgd2lkZ2V0KHNlbGYpOgogICAgICAgIGlmIHRyYWt0LmdldFRyYWt0SW5kaWNhdG9yc0luZm8oKSA9PSBUcnVlOgogICAgICAgICAgICBzZXR0aW5nID0gY29udHJvbC5zZXR0aW5nKCd0di53aWRnZXQuYWx0JykKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZXR0aW5nID0gY29udHJvbC5zZXR0aW5nKCd0di53aWRnZXQnKQoKICAgICAgICBpZiBzZXR0aW5nID09ICcyJzoKICAgICAgICAgICAgc2VsZi5jYWxlbmRhcihzZWxmLnByb2dyZXNzX2xpbmspCiAgICAgICAgZWxpZiBzZXR0aW5nID09ICczJzoKICAgICAgICAgICAgc2VsZi5jYWxlbmRhcihzZWxmLm15Y2FsZW5kYXJfbGluaykKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmNhbGVuZGFyKHNlbGYuYWRkZWRfbGluaykKCgogICAgZGVmIGNhbGVuZGFycyhzZWxmLCBpZHg9VHJ1ZSk6CiAgICAgICAgbSA9IGNvbnRyb2wubGFuZygzMjA2MCkuZW5jb2RlKCd1dGYtOCcpLnNwbGl0KCd8JykKICAgICAgICB0cnk6IG1vbnRocyA9IFsobVswXSwgJ0phbnVhcnknKSwgKG1bMV0sICdGZWJydWFyeScpLCAobVsyXSwgJ01hcmNoJyksIChtWzNdLCAnQXByaWwnKSwgKG1bNF0sICdNYXknKSwgKG1bNV0sICdKdW5lJyksIChtWzZdLCAnSnVseScpLCAobVs3XSwgJ0F1Z3VzdCcpLCAobVs4XSwgJ1NlcHRlbWJlcicpLCAobVs5XSwgJ09jdG9iZXInKSwgKG1bMTBdLCAnTm92ZW1iZXInKSwgKG1bMTFdLCAnRGVjZW1iZXInKV0KICAgICAgICBleGNlcHQ6IG1vbnRocyA9IFtdCgogICAgICAgIGQgPSBjb250cm9sLmxhbmcoMzIwNjEpLmVuY29kZSgndXRmLTgnKS5zcGxpdCgnfCcpCiAgICAgICAgdHJ5OiBkYXlzID0gWyhkWzBdLCAnTW9uZGF5JyksIChkWzFdLCAnVHVlc2RheScpLCAoZFsyXSwgJ1dlZG5lc2RheScpLCAoZFszXSwgJ1RodXJzZGF5JyksIChkWzRdLCAnRnJpZGF5JyksIChkWzVdLCAnU2F0dXJkYXknKSwgKGRbNl0sICdTdW5kYXknKV0KICAgICAgICBleGNlcHQ6IGRheXMgPSBbXQoKICAgICAgICBmb3IgaSBpbiByYW5nZSgwLCAzMCk6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIG5hbWUgPSAoc2VsZi5kYXRldGltZSAtIGRhdGV0aW1lLnRpbWVkZWx0YShkYXlzID0gaSkpCiAgICAgICAgICAgICAgICBuYW1lID0gKGNvbnRyb2wubGFuZygzMjA2MikgJSAobmFtZS5zdHJmdGltZSgnJUEnKSwgbmFtZS5zdHJmdGltZSgnJWQgJUInKSkpLmVuY29kZSgndXRmLTgnKQogICAgICAgICAgICAgICAgZm9yIG0gaW4gbW9udGhzOiBuYW1lID0gbmFtZS5yZXBsYWNlKG1bMV0sIG1bMF0pCiAgICAgICAgICAgICAgICBmb3IgZCBpbiBkYXlzOiBuYW1lID0gbmFtZS5yZXBsYWNlKGRbMV0sIGRbMF0pCiAgICAgICAgICAgICAgICB0cnk6IG5hbWUgPSBuYW1lLmVuY29kZSgndXRmLTgnKQogICAgICAgICAgICAgICAgZXhjZXB0OiBwYXNzCgogICAgICAgICAgICAgICAgdXJsID0gc2VsZi5jYWxlbmRhcl9saW5rICUgKHNlbGYuZGF0ZXRpbWUgLSBkYXRldGltZS50aW1lZGVsdGEoZGF5cyA9IGkpKS5zdHJmdGltZSgnJVktJW0tJWQnKQoKICAgICAgICAgICAgICAgIHNlbGYubGlzdC5hcHBlbmQoeyduYW1lJzogbmFtZSwgJ3VybCc6IHVybCwgJ2ltYWdlJzogJ2NhbGVuZGFyLnBuZycsICdhY3Rpb24nOiAnY2FsZW5kYXInfSkKICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgIGlmIGlkeCA9PSBUcnVlOiBzZWxmLmFkZERpcmVjdG9yeShzZWxmLmxpc3QpCiAgICAgICAgcmV0dXJuIHNlbGYubGlzdAoKCiAgICBkZWYgdXNlcmxpc3RzKHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgdXNlcmxpc3RzID0gW10KICAgICAgICAgICAgaWYgdHJha3QuZ2V0VHJha3RDcmVkZW50aWFsc0luZm8oKSA9PSBGYWxzZTogcmFpc2UgRXhjZXB0aW9uKCkKICAgICAgICAgICAgYWN0aXZpdHkgPSB0cmFrdC5nZXRBY3Rpdml0eSgpCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwYXNzCgogICAgICAgIHRyeToKICAgICAgICAgICAgaWYgdHJha3QuZ2V0VHJha3RDcmVkZW50aWFsc0luZm8oKSA9PSBGYWxzZTogcmFpc2UgRXhjZXB0aW9uKCkKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgaWYgYWN0aXZpdHkgPiBjYWNoZS50aW1lb3V0KHNlbGYudHJha3RfdXNlcl9saXN0LCBzZWxmLnRyYWt0bGlzdHNfbGluaywgc2VsZi50cmFrdF91c2VyKTogcmFpc2UgRXhjZXB0aW9uKCkKICAgICAgICAgICAgICAgIHVzZXJsaXN0cyArPSBjYWNoZS5nZXQoc2VsZi50cmFrdF91c2VyX2xpc3QsIDcyMCwgc2VsZi50cmFrdGxpc3RzX2xpbmssIHNlbGYudHJha3RfdXNlcikKICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgdXNlcmxpc3RzICs9IGNhY2hlLmdldChzZWxmLnRyYWt0X3VzZXJfbGlzdCwgMCwgc2VsZi50cmFrdGxpc3RzX2xpbmssIHNlbGYudHJha3RfdXNlcikKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHBhc3MKICAgICAgICB0cnk6CiAgICAgICAgICAgIHNlbGYubGlzdCA9IFtdCiAgICAgICAgICAgIGlmIHRyYWt0LmdldFRyYWt0Q3JlZGVudGlhbHNJbmZvKCkgPT0gRmFsc2U6IHJhaXNlIEV4Y2VwdGlvbigpCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGlmIGFjdGl2aXR5ID4gY2FjaGUudGltZW91dChzZWxmLnRyYWt0X3VzZXJfbGlzdCwgc2VsZi50cmFrdGxpa2VkbGlzdHNfbGluaywgc2VsZi50cmFrdF91c2VyKTogcmFpc2UgRXhjZXB0aW9uKCkKICAgICAgICAgICAgICAgIHVzZXJsaXN0cyArPSBjYWNoZS5nZXQoc2VsZi50cmFrdF91c2VyX2xpc3QsIDcyMCwgc2VsZi50cmFrdGxpa2VkbGlzdHNfbGluaywgc2VsZi50cmFrdF91c2VyKQogICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICB1c2VybGlzdHMgKz0gY2FjaGUuZ2V0KHNlbGYudHJha3RfdXNlcl9saXN0LCAwLCBzZWxmLnRyYWt0bGlrZWRsaXN0c19saW5rLCBzZWxmLnRyYWt0X3VzZXIpCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwYXNzCgogICAgICAgIHNlbGYubGlzdCA9IHVzZXJsaXN0cwogICAgICAgIGZvciBpIGluIHJhbmdlKDAsIGxlbihzZWxmLmxpc3QpKTogc2VsZi5saXN0W2ldLnVwZGF0ZSh7J2ltYWdlJzogJ3VzZXJsaXN0cy5wbmcnLCAnYWN0aW9uJzogJ2NhbGVuZGFyJ30pCiAgICAgICAgc2VsZi5hZGREaXJlY3Rvcnkoc2VsZi5saXN0LCBxdWV1ZT1UcnVlKQogICAgICAgIHJldHVybiBzZWxmLmxpc3QKCgogICAgZGVmIHRyYWt0X2xpc3Qoc2VsZiwgdXJsLCB1c2VyKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIGZvciBpIGluIHJlLmZpbmRhbGwoJ2RhdGVcWyhcZCspXF0nLCB1cmwpOgogICAgICAgICAgICAgICAgdXJsID0gdXJsLnJlcGxhY2UoJ2RhdGVbJXNdJyAlIGksIChzZWxmLmRhdGV0aW1lIC0gZGF0ZXRpbWUudGltZWRlbHRhKGRheXMgPSBpbnQoaSkpKS5zdHJmdGltZSgnJVktJW0tJWQnKSkKCiAgICAgICAgICAgIHEgPSBkaWN0KHVybHBhcnNlLnBhcnNlX3FzbCh1cmxwYXJzZS51cmxzcGxpdCh1cmwpLnF1ZXJ5KSkKICAgICAgICAgICAgcS51cGRhdGUoeydleHRlbmRlZCc6ICdmdWxsJ30pCiAgICAgICAgICAgIHEgPSAodXJsbGliLnVybGVuY29kZShxKSkucmVwbGFjZSgnJTJDJywgJywnKQogICAgICAgICAgICB1ID0gdXJsLnJlcGxhY2UoJz8nICsgdXJscGFyc2UudXJscGFyc2UodXJsKS5xdWVyeSwgJycpICsgJz8nICsgcQoKICAgICAgICAgICAgaXRlbWxpc3QgPSBbXQogICAgICAgICAgICBpdGVtcyA9IHRyYWt0LmdldFRyYWt0QXNKc29uKHUpCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludCgiVW5leHBlY3RlZCBlcnJvciBpbiBpbmZvIGJ1aWxkZXIgc2NyaXB0OiIsIHN5cy5leGNfaW5mbygpWzBdKQogICAgICAgICAgICBleGNfdHlwZSwgZXhjX29iaiwgZXhjX3RiID0gc3lzLmV4Y19pbmZvKCkKICAgICAgICAgICAgcHJpbnQoZXhjX3R5cGUsIGV4Y190Yi50Yl9saW5lbm8pCiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBmb3IgaXRlbSBpbiBpdGVtczoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgdGl0bGUgPSBpdGVtWydlcGlzb2RlJ11bJ3RpdGxlJ10KICAgICAgICAgICAgICAgIGlmIHRpdGxlID09IE5vbmUgb3IgdGl0bGUgPT0gJyc6IHJhaXNlIEV4Y2VwdGlvbigpCiAgICAgICAgICAgICAgICB0aXRsZSA9IGNsaWVudC5yZXBsYWNlSFRNTENvZGVzKHRpdGxlKQoKICAgICAgICAgICAgICAgIHNlYXNvbiA9IGl0ZW1bJ2VwaXNvZGUnXVsnc2Vhc29uJ10KICAgICAgICAgICAgICAgIHNlYXNvbiA9IHJlLnN1YignW14wLTldJywgJycsICclMDFkJyAlIGludChzZWFzb24pKQogICAgICAgICAgICAgICAgaWYgc2Vhc29uID09ICcwJzogcmFpc2UgRXhjZXB0aW9uKCkKCiAgICAgICAgICAgICAgICBlcGlzb2RlID0gaXRlbVsnZXBpc29kZSddWydudW1iZXInXQogICAgICAgICAgICAgICAgZXBpc29kZSA9IHJlLnN1YignW14wLTldJywgJycsICclMDFkJyAlIGludChlcGlzb2RlKSkKICAgICAgICAgICAgICAgIGlmIGVwaXNvZGUgPT0gJzAnOiByYWlzZSBFeGNlcHRpb24oKQoKICAgICAgICAgICAgICAgIHR2c2hvd3RpdGxlID0gaXRlbVsnc2hvdyddWyd0aXRsZSddCiAgICAgICAgICAgICAgICBpZiB0dnNob3d0aXRsZSA9PSBOb25lIG9yIHR2c2hvd3RpdGxlID09ICcnOiByYWlzZSBFeGNlcHRpb24oKQogICAgICAgICAgICAgICAgdHZzaG93dGl0bGUgPSBjbGllbnQucmVwbGFjZUhUTUxDb2Rlcyh0dnNob3d0aXRsZSkKCiAgICAgICAgICAgICAgICB5ZWFyID0gaXRlbVsnc2hvdyddWyd5ZWFyJ10KICAgICAgICAgICAgICAgIHllYXIgPSByZS5zdWIoJ1teMC05XScsICcnLCBzdHIoeWVhcikpCgogICAgICAgICAgICAgICAgaW1kYiA9IGl0ZW1bJ3Nob3cnXVsnaWRzJ11bJ2ltZGInXQogICAgICAgICAgICAgICAgaWYgaW1kYiA9PSBOb25lIG9yIGltZGIgPT0gJyc6IGltZGIgPSAnMCcKICAgICAgICAgICAgICAgIGVsc2U6IGltZGIgPSAndHQnICsgcmUuc3ViKCdbXjAtOV0nLCAnJywgc3RyKGltZGIpKQoKICAgICAgICAgICAgICAgIHR2ZGIgPSBpdGVtWydzaG93J11bJ2lkcyddWyd0dmRiJ10KICAgICAgICAgICAgICAgIGlmIHR2ZGIgPT0gTm9uZSBvciB0dmRiID09ICcnOiByYWlzZSBFeGNlcHRpb24oKQogICAgICAgICAgICAgICAgdHZkYiA9IHJlLnN1YignW14wLTldJywgJycsIHN0cih0dmRiKSkKCiAgICAgICAgICAgICAgICBwcmVtaWVyZWQgPSBpdGVtWydlcGlzb2RlJ11bJ2ZpcnN0X2FpcmVkJ10KICAgICAgICAgICAgICAgIHRyeTogcHJlbWllcmVkID0gcmUuY29tcGlsZSgnKFxkezR9LVxkezJ9LVxkezJ9KScpLmZpbmRhbGwocHJlbWllcmVkKVswXQogICAgICAgICAgICAgICAgZXhjZXB0OiBwcmVtaWVyZWQgPSAnMCcKCiAgICAgICAgICAgICAgICBzdHVkaW8gPSBpdGVtWydzaG93J11bJ25ldHdvcmsnXQogICAgICAgICAgICAgICAgaWYgc3R1ZGlvID09IE5vbmU6IHN0dWRpbyA9ICcwJwoKICAgICAgICAgICAgICAgIGdlbnJlID0gaXRlbVsnc2hvdyddWydnZW5yZXMnXQogICAgICAgICAgICAgICAgZ2VucmUgPSBbaS50aXRsZSgpIGZvciBpIGluIGdlbnJlXQogICAgICAgICAgICAgICAgaWYgZ2VucmUgPT0gW106IGdlbnJlID0gJzAnCiAgICAgICAgICAgICAgICBnZW5yZSA9ICcgLyAnLmpvaW4oZ2VucmUpCgogICAgICAgICAgICAgICAgdHJ5OiBkdXJhdGlvbiA9IHN0cihpdGVtWydzaG93J11bJ3J1bnRpbWUnXSkKICAgICAgICAgICAgICAgIGV4Y2VwdDogZHVyYXRpb24gPSAnMCcKICAgICAgICAgICAgICAgIGlmIGR1cmF0aW9uID09IE5vbmU6IGR1cmF0aW9uID0gJzAnCgogICAgICAgICAgICAgICAgdHJ5OiByYXRpbmcgPSBzdHIoaXRlbVsnZXBpc29kZSddWydyYXRpbmcnXSkKICAgICAgICAgICAgICAgIGV4Y2VwdDogcmF0aW5nID0gJzAnCiAgICAgICAgICAgICAgICBpZiByYXRpbmcgPT0gTm9uZSBvciByYXRpbmcgPT0gJzAuMCc6IHJhdGluZyA9ICcwJwoKICAgICAgICAgICAgICAgIHRyeTogdm90ZXMgPSBzdHIoaXRlbVsnc2hvdyddWyd2b3RlcyddKQogICAgICAgICAgICAgICAgZXhjZXB0OiB2b3RlcyA9ICcwJwogICAgICAgICAgICAgICAgdHJ5OiB2b3RlcyA9IHN0cihmb3JtYXQoaW50KHZvdGVzKSwnLGQnKSkKICAgICAgICAgICAgICAgIGV4Y2VwdDogcGFzcwogICAgICAgICAgICAgICAgaWYgdm90ZXMgPT0gTm9uZTogdm90ZXMgPSAnMCcKCiAgICAgICAgICAgICAgICBtcGFhID0gaXRlbVsnc2hvdyddWydjZXJ0aWZpY2F0aW9uJ10KICAgICAgICAgICAgICAgIGlmIG1wYWEgPT0gTm9uZTogbXBhYSA9ICcwJwoKICAgICAgICAgICAgICAgIHBsb3QgPSBpdGVtWydlcGlzb2RlJ11bJ292ZXJ2aWV3J10KICAgICAgICAgICAgICAgIGlmIHBsb3QgPT0gTm9uZSBvciBwbG90ID09ICcnOiBwbG90ID0gaXRlbVsnc2hvdyddWydvdmVydmlldyddCiAgICAgICAgICAgICAgICBpZiBwbG90ID09IE5vbmUgb3IgcGxvdCA9PSAnJzogcGxvdCA9ICcwJwogICAgICAgICAgICAgICAgcGxvdCA9IGNsaWVudC5yZXBsYWNlSFRNTENvZGVzKHBsb3QpCgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIGlmIHNlbGYubGFuZyA9PSAnZW4nOiByYWlzZSBFeGNlcHRpb24oKQoKICAgICAgICAgICAgICAgICAgICBpdGVtID0gdHJha3QuZ2V0VFZTaG93VHJhbnNsYXRpb24oaW1kYiwgbGFuZz1zZWxmLmxhbmcsIHNlYXNvbj1zZWFzb24sIGVwaXNvZGU9ZXBpc29kZSwgIGZ1bGw9VHJ1ZSkKCiAgICAgICAgICAgICAgICAgICAgdGl0bGUgPSBpdGVtLmdldCgndGl0bGUnKSBvciB0aXRsZQogICAgICAgICAgICAgICAgICAgIHBsb3QgPSBpdGVtLmdldCgnb3ZlcnZpZXcnKSBvciBwbG90CgogICAgICAgICAgICAgICAgICAgIHR2c2hvd3RpdGxlID0gdHJha3QuZ2V0VFZTaG93VHJhbnNsYXRpb24oaW1kYiwgbGFuZz1zZWxmLmxhbmcpIG9yIHR2c2hvd3RpdGxlCiAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICAgICAgICAgIGl0ZW1saXN0LmFwcGVuZCh7J3RpdGxlJzogdGl0bGUsICdzZWFzb24nOiBzZWFzb24sICdlcGlzb2RlJzogZXBpc29kZSwgJ3R2c2hvd3RpdGxlJzogdHZzaG93dGl0bGUsICd5ZWFyJzogeWVhciwgJ3ByZW1pZXJlZCc6IHByZW1pZXJlZCwgJ3N0YXR1cyc6ICdDb250aW51aW5nJywgJ3N0dWRpbyc6IHN0dWRpbywgJ2dlbnJlJzogZ2VucmUsICdkdXJhdGlvbic6IGR1cmF0aW9uLCAncmF0aW5nJzogcmF0aW5nLCAndm90ZXMnOiB2b3RlcywgJ21wYWEnOiBtcGFhLCAncGxvdCc6IHBsb3QsICdpbWRiJzogaW1kYiwgJ3R2ZGInOiB0dmRiLCAncG9zdGVyJzogJzAnLCAndGh1bWInOiAnMCd9KQogICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICBwYXNzCgogICAgICAgIGl0ZW1saXN0ID0gaXRlbWxpc3RbOjotMV0KICAgICAgICByZXR1cm4gaXRlbWxpc3QKCgogICAgZGVmIHRyYWt0X3Byb2dyZXNzX2xpc3Qoc2VsZiwgdXJsLCB1c2VyLCBsYW5nKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVybCArPSAnP2V4dGVuZGVkPWZ1bGwnCiAgICAgICAgICAgIHJlc3VsdCA9IHRyYWt0LmdldFRyYWt0QXNKc29uKHVybCkKICAgICAgICAgICAgaXRlbXMgPSBbXQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIHNvcnRvcmRlciA9IGNvbnRyb2wuc2V0dGluZygncHJnci5zb3J0b3JkZXInKQogICAgICAgIGZvciBpdGVtIGluIHJlc3VsdDoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgbnVtXzEgPSAwCiAgICAgICAgICAgICAgICBmb3IgaSBpbiByYW5nZSgwLCBsZW4oaXRlbVsnc2Vhc29ucyddKSk6CiAgICAgICAgICAgICAgICAgICAgaWYgaXRlbVsnc2Vhc29ucyddW2ldWydudW1iZXInXSA+IDA6IG51bV8xICs9IGxlbihpdGVtWydzZWFzb25zJ11baV1bJ2VwaXNvZGVzJ10pCiAgICAgICAgICAgICAgICBudW1fMiA9IGludChpdGVtWydzaG93J11bJ2FpcmVkX2VwaXNvZGVzJ10pCiAgICAgICAgICAgICAgICBpZiBudW1fMSA+PSBudW1fMjogcmFpc2UgRXhjZXB0aW9uKCkKCiAgICAgICAgICAgICAgICBzZWFzb24gPSBzdHIoaXRlbVsnc2Vhc29ucyddWy0xXVsnbnVtYmVyJ10pCgogICAgICAgICAgICAgICAgZXBpc29kZSA9IFt4IGZvciB4IGluIGl0ZW1bJ3NlYXNvbnMnXVstMV1bJ2VwaXNvZGVzJ10gaWYgJ251bWJlcicgaW4geF0KICAgICAgICAgICAgICAgIGVwaXNvZGUgPSBzb3J0ZWQoZXBpc29kZSwga2V5PWxhbWJkYSB4OiB4WydudW1iZXInXSkKICAgICAgICAgICAgICAgIGVwaXNvZGUgPSBzdHIoZXBpc29kZVstMV1bJ251bWJlciddKQoKICAgICAgICAgICAgICAgIHR2c2hvd3RpdGxlID0gaXRlbVsnc2hvdyddWyd0aXRsZSddCiAgICAgICAgICAgICAgICBpZiB0dnNob3d0aXRsZSA9PSBOb25lIG9yIHR2c2hvd3RpdGxlID09ICcnOiByYWlzZSBFeGNlcHRpb24oKQogICAgICAgICAgICAgICAgdHZzaG93dGl0bGUgPSBjbGllbnQucmVwbGFjZUhUTUxDb2Rlcyh0dnNob3d0aXRsZSkKCiAgICAgICAgICAgICAgICB5ZWFyID0gaXRlbVsnc2hvdyddWyd5ZWFyJ10KICAgICAgICAgICAgICAgIHllYXIgPSByZS5zdWIoJ1teMC05XScsICcnLCBzdHIoeWVhcikpCiAgICAgICAgICAgICAgICBpZiBpbnQoeWVhcikgPiBpbnQoc2VsZi5kYXRldGltZS5zdHJmdGltZSgnJVknKSk6IHJhaXNlIEV4Y2VwdGlvbigpCgogICAgICAgICAgICAgICAgaW1kYiA9IGl0ZW1bJ3Nob3cnXVsnaWRzJ11bJ2ltZGInXQogICAgICAgICAgICAgICAgaWYgaW1kYiA9PSBOb25lIG9yIGltZGIgPT0gJyc6IGltZGIgPSAnMCcKCiAgICAgICAgICAgICAgICB0dmRiID0gaXRlbVsnc2hvdyddWydpZHMnXVsndHZkYiddCiAgICAgICAgICAgICAgICBpZiB0dmRiID09IE5vbmUgb3IgdHZkYiA9PSAnJzogcmFpc2UgRXhjZXB0aW9uKCkKICAgICAgICAgICAgICAgIHR2ZGIgPSByZS5zdWIoJ1teMC05XScsICcnLCBzdHIodHZkYikpCgogICAgICAgICAgICAgICAgbGFzdF93YXRjaGVkID0gaXRlbVsnbGFzdF93YXRjaGVkX2F0J10KICAgICAgICAgICAgICAgIGlmIGxhc3Rfd2F0Y2hlZCA9PSBOb25lIG9yIGxhc3Rfd2F0Y2hlZCA9PSAnJzogbGFzdF93YXRjaGVkID0gJzAnCiAgICAgICAgICAgICAgICBpdGVtcy5hcHBlbmQoeydpbWRiJzogaW1kYiwgJ3R2ZGInOiB0dmRiLCAndHZzaG93dGl0bGUnOiB0dnNob3d0aXRsZSwgJ3llYXInOiB5ZWFyLCAnc251bSc6IHNlYXNvbiwgJ2VudW0nOiBlcGlzb2RlLCAnX2xhc3Rfd2F0Y2hlZCc6IGxhc3Rfd2F0Y2hlZH0pCiAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgdHJ5OgogICAgICAgICAgICByZXN1bHQgPSB0cmFrdC5nZXRUcmFrdEFzSnNvbihzZWxmLmhpZGRlbnByb2dyZXNzX2xpbmspCiAgICAgICAgICAgIHJlc3VsdCA9IFtzdHIoaVsnc2hvdyddWydpZHMnXVsndHZkYiddKSBmb3IgaSBpbiByZXN1bHRdCgogICAgICAgICAgICBpdGVtcyA9IFtpIGZvciBpIGluIGl0ZW1zIGlmIG5vdCBpWyd0dmRiJ10gaW4gcmVzdWx0XQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcGFzcwoKICAgICAgICBkZWYgaXRlbXNfbGlzdChpKToKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgaXRlbSA9IFt4IGZvciB4IGluIHNlbGYuYmxpc3QgaWYgeFsndHZkYiddID09IGlbJ3R2ZGInXSBhbmQgeFsnc251bSddID09IGlbJ3NudW0nXSBhbmQgeFsnZW51bSddID09IGlbJ2VudW0nXV1bMF0KICAgICAgICAgICAgICAgIGl0ZW1bJ2FjdGlvbiddID0gJ2VwaXNvZGVzJwogICAgICAgICAgICAgICAgc2VsZi5saXN0LmFwcGVuZChpdGVtKQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHVybCA9IHNlbGYudHZkYl9pbmZvX2xpbmsgJSAoaVsndHZkYiddLCBsYW5nKQogICAgICAgICAgICAgICAgZGF0YSA9IHVybGxpYjIudXJsb3Blbih1cmwsIHRpbWVvdXQ9MTApLnJlYWQoKQoKICAgICAgICAgICAgICAgIHppcCA9IHppcGZpbGUuWmlwRmlsZShTdHJpbmdJTy5TdHJpbmdJTyhkYXRhKSkKICAgICAgICAgICAgICAgIHJlc3VsdCA9IHppcC5yZWFkKCclcy54bWwnICUgbGFuZykKICAgICAgICAgICAgICAgIGFydHdvcmsgPSB6aXAucmVhZCgnYmFubmVycy54bWwnKQogICAgICAgICAgICAgICAgemlwLmNsb3NlKCkKCiAgICAgICAgICAgICAgICByZXN1bHQgPSByZXN1bHQuc3BsaXQoJzxFcGlzb2RlPicpCiAgICAgICAgICAgICAgICBpdGVtID0gW3ggZm9yIHggaW4gcmVzdWx0IGlmICc8RXBpc29kZU51bWJlcj4nIGluIHhdCiAgICAgICAgICAgICAgICBpdGVtMiA9IHJlc3VsdFswXQoKICAgICAgICAgICAgICAgIG51bSA9IFt4IGZvciB4LHkgaW4gZW51bWVyYXRlKGl0ZW0pIGlmIHJlLmNvbXBpbGUoJzxTZWFzb25OdW1iZXI+KC4rPyk8L1NlYXNvbk51bWJlcj4nKS5maW5kYWxsKHkpWzBdID09IHN0cihpWydzbnVtJ10pIGFuZCByZS5jb21waWxlKCc8RXBpc29kZU51bWJlcj4oLis/KTwvRXBpc29kZU51bWJlcj4nKS5maW5kYWxsKHkpWzBdID09IHN0cihpWydlbnVtJ10pXVstMV0KICAgICAgICAgICAgICAgIGl0ZW0gPSBbeSBmb3IgeCx5IGluIGVudW1lcmF0ZShpdGVtKSBpZiB4ID4gbnVtXVswXQoKICAgICAgICAgICAgICAgIHByaW50IGxhbmcKICAgICAgICAgICAgICAgIHByaW50IGl0ZW0KCiAgICAgICAgICAgICAgICBwcmVtaWVyZWQgPSBjbGllbnQucGFyc2VET00oaXRlbSwgJ0ZpcnN0QWlyZWQnKVswXQogICAgICAgICAgICAgICAgaWYgcHJlbWllcmVkID09ICcnIG9yICctMDAnIGluIHByZW1pZXJlZDogcHJlbWllcmVkID0gJzAnCiAgICAgICAgICAgICAgICBwcmVtaWVyZWQgPSBjbGllbnQucmVwbGFjZUhUTUxDb2RlcyhwcmVtaWVyZWQpCiAgICAgICAgICAgICAgICBwcmVtaWVyZWQgPSBwcmVtaWVyZWQuZW5jb2RlKCd1dGYtOCcpCgogICAgICAgICAgICAgICAgdHJ5OiBzdGF0dXMgPSBjbGllbnQucGFyc2VET00oaXRlbTIsICdTdGF0dXMnKVswXQogICAgICAgICAgICAgICAgZXhjZXB0OiBzdGF0dXMgPSAnJwogICAgICAgICAgICAgICAgaWYgc3RhdHVzID09ICcnOiBzdGF0dXMgPSAnRW5kZWQnCiAgICAgICAgICAgICAgICBzdGF0dXMgPSBjbGllbnQucmVwbGFjZUhUTUxDb2RlcyhzdGF0dXMpCiAgICAgICAgICAgICAgICBzdGF0dXMgPSBzdGF0dXMuZW5jb2RlKCd1dGYtOCcpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIHVuYWlyZWQgPSAnJwoKICAgICAgICAgICAgICAgIGlmIHN0YXR1cyA9PSAnRW5kZWQnOiBwYXNzCiAgICAgICAgICAgICAgICBlbGlmIHByZW1pZXJlZCA9PSAnMCc6IHJhaXNlIEV4Y2VwdGlvbigpCiAgICAgICAgICAgICAgICBlbGlmIGludChyZS5zdWIoJ1teMC05XScsICcnLCBzdHIocHJlbWllcmVkKSkpID4gaW50KHJlLnN1YignW14wLTldJywgJycsIHN0cihzZWxmLnRvZGF5X2RhdGUpKSk6CiAgICAgICAgICAgICAgICAgICAgdW5haXJlZCA9ICd0cnVlJwogICAgICAgICAgICAgICAgICAgIGlmIHNlbGYuc2hvd3VuYWlyZWQgIT0gJ3RydWUnOiByYWlzZSBFeGNlcHRpb24oKQoKICAgICAgICAgICAgICAgIHRpdGxlID0gY2xpZW50LnBhcnNlRE9NKGl0ZW0sICdFcGlzb2RlTmFtZScpWzBdCiAgICAgICAgICAgICAgICBpZiB0aXRsZSA9PSAnJzogdGl0bGUgPSAnMCcKICAgICAgICAgICAgICAgIHRpdGxlID0gY2xpZW50LnJlcGxhY2VIVE1MQ29kZXModGl0bGUpCiAgICAgICAgICAgICAgICB0aXRsZSA9IHRpdGxlLmVuY29kZSgndXRmLTgnKQoKICAgICAgICAgICAgICAgIHNlYXNvbiA9IGNsaWVudC5wYXJzZURPTShpdGVtLCAnU2Vhc29uTnVtYmVyJylbMF0KICAgICAgICAgICAgICAgIHNlYXNvbiA9ICclMDFkJyAlIGludChzZWFzb24pCiAgICAgICAgICAgICAgICBzZWFzb24gPSBzZWFzb24uZW5jb2RlKCd1dGYtOCcpCgogICAgICAgICAgICAgICAgZXBpc29kZSA9IGNsaWVudC5wYXJzZURPTShpdGVtLCAnRXBpc29kZU51bWJlcicpWzBdCiAgICAgICAgICAgICAgICBlcGlzb2RlID0gcmUuc3ViKCdbXjAtOV0nLCAnJywgJyUwMWQnICUgaW50KGVwaXNvZGUpKQogICAgICAgICAgICAgICAgZXBpc29kZSA9IGVwaXNvZGUuZW5jb2RlKCd1dGYtOCcpCgogICAgICAgICAgICAgICAgdHZzaG93dGl0bGUgPSBpWyd0dnNob3d0aXRsZSddCiAgICAgICAgICAgICAgICBpbWRiLCB0dmRiID0gaVsnaW1kYiddLCBpWyd0dmRiJ10KCiAgICAgICAgICAgICAgICB5ZWFyID0gaVsneWVhciddCiAgICAgICAgICAgICAgICB0cnk6IHllYXIgPSB5ZWFyLmVuY29kZSgndXRmLTgnKQogICAgICAgICAgICAgICAgZXhjZXB0OiBwYXNzCgogICAgICAgICAgICAgICAgdHJ5OiBwb3N0ZXIgPSBjbGllbnQucGFyc2VET00oaXRlbTIsICdwb3N0ZXInKVswXQogICAgICAgICAgICAgICAgZXhjZXB0OiBwb3N0ZXIgPSAnJwogICAgICAgICAgICAgICAgaWYgbm90IHBvc3RlciA9PSAnJzogcG9zdGVyID0gc2VsZi50dmRiX2ltYWdlICsgcG9zdGVyCiAgICAgICAgICAgICAgICBlbHNlOiBwb3N0ZXIgPSAnMCcKICAgICAgICAgICAgICAgIHBvc3RlciA9IGNsaWVudC5yZXBsYWNlSFRNTENvZGVzKHBvc3RlcikKICAgICAgICAgICAgICAgIHBvc3RlciA9IHBvc3Rlci5lbmNvZGUoJ3V0Zi04JykKCiAgICAgICAgICAgICAgICB0cnk6IGJhbm5lciA9IGNsaWVudC5wYXJzZURPTShpdGVtMiwgJ2Jhbm5lcicpWzBdCiAgICAgICAgICAgICAgICBleGNlcHQ6IGJhbm5lciA9ICcnCiAgICAgICAgICAgICAgICBpZiBub3QgYmFubmVyID09ICcnOiBiYW5uZXIgPSBzZWxmLnR2ZGJfaW1hZ2UgKyBiYW5uZXIKICAgICAgICAgICAgICAgIGVsc2U6IGJhbm5lciA9ICcwJwogICAgICAgICAgICAgICAgYmFubmVyID0gY2xpZW50LnJlcGxhY2VIVE1MQ29kZXMoYmFubmVyKQogICAgICAgICAgICAgICAgYmFubmVyID0gYmFubmVyLmVuY29kZSgndXRmLTgnKQoKICAgICAgICAgICAgICAgIHRyeTogZmFuYXJ0ID0gY2xpZW50LnBhcnNlRE9NKGl0ZW0yLCAnZmFuYXJ0JylbMF0KICAgICAgICAgICAgICAgIGV4Y2VwdDogZmFuYXJ0ID0gJycKICAgICAgICAgICAgICAgIGlmIG5vdCBmYW5hcnQgPT0gJyc6IGZhbmFydCA9IHNlbGYudHZkYl9pbWFnZSArIGZhbmFydAogICAgICAgICAgICAgICAgZWxzZTogZmFuYXJ0ID0gJzAnCiAgICAgICAgICAgICAgICBmYW5hcnQgPSBjbGllbnQucmVwbGFjZUhUTUxDb2RlcyhmYW5hcnQpCiAgICAgICAgICAgICAgICBmYW5hcnQgPSBmYW5hcnQuZW5jb2RlKCd1dGYtOCcpCgogICAgICAgICAgICAgICAgdHJ5OiB0aHVtYiA9IGNsaWVudC5wYXJzZURPTShpdGVtLCAnZmlsZW5hbWUnKVswXQogICAgICAgICAgICAgICAgZXhjZXB0OiB0aHVtYiA9ICcnCiAgICAgICAgICAgICAgICBpZiBub3QgdGh1bWIgPT0gJyc6IHRodW1iID0gc2VsZi50dmRiX2ltYWdlICsgdGh1bWIKICAgICAgICAgICAgICAgIGVsc2U6IHRodW1iID0gJzAnCiAgICAgICAgICAgICAgICB0aHVtYiA9IGNsaWVudC5yZXBsYWNlSFRNTENvZGVzKHRodW1iKQogICAgICAgICAgICAgICAgdGh1bWIgPSB0aHVtYi5lbmNvZGUoJ3V0Zi04JykKCiAgICAgICAgICAgICAgICBpZiBub3QgcG9zdGVyID09ICcwJzogcGFzcwogICAgICAgICAgICAgICAgZWxpZiBub3QgZmFuYXJ0ID09ICcwJzogcG9zdGVyID0gZmFuYXJ0CiAgICAgICAgICAgICAgICBlbGlmIG5vdCBiYW5uZXIgPT0gJzAnOiBwb3N0ZXIgPSBiYW5uZXIKCiAgICAgICAgICAgICAgICBpZiBub3QgYmFubmVyID09ICcwJzogcGFzcwogICAgICAgICAgICAgICAgZWxpZiBub3QgZmFuYXJ0ID09ICcwJzogYmFubmVyID0gZmFuYXJ0CiAgICAgICAgICAgICAgICBlbGlmIG5vdCBwb3N0ZXIgPT0gJzAnOiBiYW5uZXIgPSBwb3N0ZXIKCiAgICAgICAgICAgICAgICBpZiBub3QgdGh1bWIgPT0gJzAnOiBwYXNzCiAgICAgICAgICAgICAgICBlbGlmIG5vdCBmYW5hcnQgPT0gJzAnOiB0aHVtYiA9IGZhbmFydC5yZXBsYWNlKHNlbGYudHZkYl9pbWFnZSwgc2VsZi50dmRiX3Bvc3RlcikKICAgICAgICAgICAgICAgIGVsaWYgbm90IHBvc3RlciA9PSAnMCc6IHRodW1iID0gcG9zdGVyCgogICAgICAgICAgICAgICAgdHJ5OiBzdHVkaW8gPSBjbGllbnQucGFyc2VET00oaXRlbTIsICdOZXR3b3JrJylbMF0KICAgICAgICAgICAgICAgIGV4Y2VwdDogc3R1ZGlvID0gJycKICAgICAgICAgICAgICAgIGlmIHN0dWRpbyA9PSAnJzogc3R1ZGlvID0gJzAnCiAgICAgICAgICAgICAgICBzdHVkaW8gPSBjbGllbnQucmVwbGFjZUhUTUxDb2RlcyhzdHVkaW8pCiAgICAgICAgICAgICAgICBzdHVkaW8gPSBzdHVkaW8uZW5jb2RlKCd1dGYtOCcpCgogICAgICAgICAgICAgICAgdHJ5OiBnZW5yZSA9IGNsaWVudC5wYXJzZURPTShpdGVtMiwgJ0dlbnJlJylbMF0KICAgICAgICAgICAgICAgIGV4Y2VwdDogZ2VucmUgPSAnJwogICAgICAgICAgICAgICAgZ2VucmUgPSBbeCBmb3IgeCBpbiBnZW5yZS5zcGxpdCgnfCcpIGlmIG5vdCB4ID09ICcnXQogICAgICAgICAgICAgICAgZ2VucmUgPSAnIC8gJy5qb2luKGdlbnJlKQogICAgICAgICAgICAgICAgaWYgZ2VucmUgPT0gJyc6IGdlbnJlID0gJzAnCiAgICAgICAgICAgICAgICBnZW5yZSA9IGNsaWVudC5yZXBsYWNlSFRNTENvZGVzKGdlbnJlKQogICAgICAgICAgICAgICAgZ2VucmUgPSBnZW5yZS5lbmNvZGUoJ3V0Zi04JykKCiAgICAgICAgICAgICAgICB0cnk6IGR1cmF0aW9uID0gY2xpZW50LnBhcnNlRE9NKGl0ZW0yLCAnUnVudGltZScpWzBdCiAgICAgICAgICAgICAgICBleGNlcHQ6IGR1cmF0aW9uID0gJycKICAgICAgICAgICAgICAgIGlmIGR1cmF0aW9uID09ICcnOiBkdXJhdGlvbiA9ICcwJwogICAgICAgICAgICAgICAgZHVyYXRpb24gPSBjbGllbnQucmVwbGFjZUhUTUxDb2RlcyhkdXJhdGlvbikKICAgICAgICAgICAgICAgIGR1cmF0aW9uID0gZHVyYXRpb24uZW5jb2RlKCd1dGYtOCcpCgogICAgICAgICAgICAgICAgdHJ5OiByYXRpbmcgPSBjbGllbnQucGFyc2VET00oaXRlbSwgJ1JhdGluZycpWzBdCiAgICAgICAgICAgICAgICBleGNlcHQ6IHJhdGluZyA9ICcnCiAgICAgICAgICAgICAgICBpZiByYXRpbmcgPT0gJyc6IHJhdGluZyA9ICcwJwogICAgICAgICAgICAgICAgcmF0aW5nID0gY2xpZW50LnJlcGxhY2VIVE1MQ29kZXMocmF0aW5nKQogICAgICAgICAgICAgICAgcmF0aW5nID0gcmF0aW5nLmVuY29kZSgndXRmLTgnKQoKICAgICAgICAgICAgICAgIHRyeTogdm90ZXMgPSBjbGllbnQucGFyc2VET00oaXRlbTIsICdSYXRpbmdDb3VudCcpWzBdCiAgICAgICAgICAgICAgICBleGNlcHQ6IHZvdGVzID0gJzAnCiAgICAgICAgICAgICAgICBpZiB2b3RlcyA9PSAnJzogdm90ZXMgPSAnMCcKICAgICAgICAgICAgICAgIHZvdGVzID0gY2xpZW50LnJlcGxhY2VIVE1MQ29kZXModm90ZXMpCiAgICAgICAgICAgICAgICB2b3RlcyA9IHZvdGVzLmVuY29kZSgndXRmLTgnKQoKICAgICAgICAgICAgICAgIHRyeTogbXBhYSA9IGNsaWVudC5wYXJzZURPTShpdGVtMiwgJ0NvbnRlbnRSYXRpbmcnKVswXQogICAgICAgICAgICAgICAgZXhjZXB0OiBtcGFhID0gJycKICAgICAgICAgICAgICAgIGlmIG1wYWEgPT0gJyc6IG1wYWEgPSAnMCcKICAgICAgICAgICAgICAgIG1wYWEgPSBjbGllbnQucmVwbGFjZUhUTUxDb2RlcyhtcGFhKQogICAgICAgICAgICAgICAgbXBhYSA9IG1wYWEuZW5jb2RlKCd1dGYtOCcpCgogICAgICAgICAgICAgICAgdHJ5OiBkaXJlY3RvciA9IGNsaWVudC5wYXJzZURPTShpdGVtLCAnRGlyZWN0b3InKVswXQogICAgICAgICAgICAgICAgZXhjZXB0OiBkaXJlY3RvciA9ICcnCiAgICAgICAgICAgICAgICBkaXJlY3RvciA9IFt4IGZvciB4IGluIGRpcmVjdG9yLnNwbGl0KCd8JykgaWYgbm90IHggPT0gJyddCiAgICAgICAgICAgICAgICBkaXJlY3RvciA9ICcgLyAnLmpvaW4oZGlyZWN0b3IpCiAgICAgICAgICAgICAgICBpZiBkaXJlY3RvciA9PSAnJzogZGlyZWN0b3IgPSAnMCcKICAgICAgICAgICAgICAgIGRpcmVjdG9yID0gY2xpZW50LnJlcGxhY2VIVE1MQ29kZXMoZGlyZWN0b3IpCiAgICAgICAgICAgICAgICBkaXJlY3RvciA9IGRpcmVjdG9yLmVuY29kZSgndXRmLTgnKQoKICAgICAgICAgICAgICAgIHRyeTogd3JpdGVyID0gY2xpZW50LnBhcnNlRE9NKGl0ZW0sICdXcml0ZXInKVswXQogICAgICAgICAgICAgICAgZXhjZXB0OiB3cml0ZXIgPSAnJwogICAgICAgICAgICAgICAgd3JpdGVyID0gW3ggZm9yIHggaW4gd3JpdGVyLnNwbGl0KCd8JykgaWYgbm90IHggPT0gJyddCiAgICAgICAgICAgICAgICB3cml0ZXIgPSAnIC8gJy5qb2luKHdyaXRlcikKICAgICAgICAgICAgICAgIGlmIHdyaXRlciA9PSAnJzogd3JpdGVyID0gJzAnCiAgICAgICAgICAgICAgICB3cml0ZXIgPSBjbGllbnQucmVwbGFjZUhUTUxDb2Rlcyh3cml0ZXIpCiAgICAgICAgICAgICAgICB3cml0ZXIgPSB3cml0ZXIuZW5jb2RlKCd1dGYtOCcpCgogICAgICAgICAgICAgICAgdHJ5OiBjYXN0ID0gY2xpZW50LnBhcnNlRE9NKGl0ZW0yLCAnQWN0b3JzJylbMF0KICAgICAgICAgICAgICAgIGV4Y2VwdDogY2FzdCA9ICcnCiAgICAgICAgICAgICAgICBjYXN0ID0gW3ggZm9yIHggaW4gY2FzdC5zcGxpdCgnfCcpIGlmIG5vdCB4ID09ICcnXQogICAgICAgICAgICAgICAgdHJ5OiBjYXN0ID0gWyh4LmVuY29kZSgndXRmLTgnKSwgJycpIGZvciB4IGluIGNhc3RdCiAgICAgICAgICAgICAgICBleGNlcHQ6IGNhc3QgPSBbXQoKICAgICAgICAgICAgICAgIHRyeTogcGxvdCA9IGNsaWVudC5wYXJzZURPTShpdGVtLCAnT3ZlcnZpZXcnKVswXQogICAgICAgICAgICAgICAgZXhjZXB0OiBwbG90ID0gJycKICAgICAgICAgICAgICAgIGlmIHBsb3QgPT0gJyc6CiAgICAgICAgICAgICAgICAgICAgdHJ5OiBwbG90ID0gY2xpZW50LnBhcnNlRE9NKGl0ZW0yLCAnT3ZlcnZpZXcnKVswXQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdDogcGxvdCA9ICcnCiAgICAgICAgICAgICAgICBpZiBwbG90ID09ICcnOiBwbG90ID0gJzAnCiAgICAgICAgICAgICAgICBwbG90ID0gY2xpZW50LnJlcGxhY2VIVE1MQ29kZXMocGxvdCkKICAgICAgICAgICAgICAgIHBsb3QgPSBwbG90LmVuY29kZSgndXRmLTgnKQoKICAgICAgICAgICAgICAgIHNlbGYubGlzdC5hcHBlbmQoeyd0aXRsZSc6IHRpdGxlLCAnc2Vhc29uJzogc2Vhc29uLCAnZXBpc29kZSc6IGVwaXNvZGUsICd0dnNob3d0aXRsZSc6IHR2c2hvd3RpdGxlLCAneWVhcic6IHllYXIsICdwcmVtaWVyZWQnOiBwcmVtaWVyZWQsICdzdGF0dXMnOiBzdGF0dXMsICdzdHVkaW8nOiBzdHVkaW8sICdnZW5yZSc6IGdlbnJlLCAnZHVyYXRpb24nOiBkdXJhdGlvbiwgJ3JhdGluZyc6IHJhdGluZywgJ3ZvdGVzJzogdm90ZXMsICdtcGFhJzogbXBhYSwgJ2RpcmVjdG9yJzogZGlyZWN0b3IsICd3cml0ZXInOiB3cml0ZXIsICdjYXN0JzogY2FzdCwgJ3Bsb3QnOiBwbG90LCAnaW1kYic6IGltZGIsICd0dmRiJzogdHZkYiwgJ3Bvc3Rlcic6IHBvc3RlciwgJ2Jhbm5lcic6IGJhbm5lciwgJ2ZhbmFydCc6IGZhbmFydCwgJ3RodW1iJzogdGh1bWIsICdzbnVtJzogaVsnc251bSddLCAnZW51bSc6IGlbJ2VudW0nXSwgJ2FjdGlvbic6ICdlcGlzb2RlcycsICd1bmFpcmVkJzogdW5haXJlZCwgJ19sYXN0X3dhdGNoZWQnOiBpWydfbGFzdF93YXRjaGVkJ10sICdfc29ydF9rZXknOiBtYXgoaVsnX2xhc3Rfd2F0Y2hlZCddLHByZW1pZXJlZCl9KQogICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICBwYXNzCgoKICAgICAgICBpdGVtcyA9IGl0ZW1zWzoxMDBdCgogICAgICAgIHRocmVhZHMgPSBbXQogICAgICAgIGZvciBpIGluIGl0ZW1zOiB0aHJlYWRzLmFwcGVuZCh3b3JrZXJzLlRocmVhZChpdGVtc19saXN0LCBpKSkKICAgICAgICBbaS5zdGFydCgpIGZvciBpIGluIHRocmVhZHNdCiAgICAgICAgW2kuam9pbigpIGZvciBpIGluIHRocmVhZHNdCgoKICAgICAgICB0cnk6CiAgICAgICAgICAgIGlmIHNvcnRvcmRlciA9PSAnMCc6CiAgICAgICAgICAgICAgICBzZWxmLmxpc3QgPSBzb3J0ZWQoc2VsZi5saXN0LCBrZXk9bGFtYmRhIGs6IGtbJ3ByZW1pZXJlZCddLCByZXZlcnNlPVRydWUpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLmxpc3QgPSBzb3J0ZWQoc2VsZi5saXN0LCBrZXk9bGFtYmRhIGs6IGtbJ19zb3J0X2tleSddLCByZXZlcnNlPVRydWUpCiAgICAgICAgZXhjZXB0OiBwYXNzCgogICAgICAgIHJldHVybiBzZWxmLmxpc3QKCgogICAgZGVmIHRyYWt0X2VwaXNvZGVzX2xpc3Qoc2VsZiwgdXJsLCB1c2VyLCBsYW5nKToKICAgICAgICBpdGVtcyA9IHNlbGYudHJha3RfbGlzdCh1cmwsIHVzZXIpCgogICAgICAgIGRlZiBpdGVtc19saXN0KGkpOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBpdGVtID0gW3ggZm9yIHggaW4gc2VsZi5ibGlzdCBpZiB4Wyd0dmRiJ10gPT0gaVsndHZkYiddIGFuZCB4WydzZWFzb24nXSA9PSBpWydzZWFzb24nXSBhbmQgeFsnZXBpc29kZSddID09IGlbJ2VwaXNvZGUnXV1bMF0KICAgICAgICAgICAgICAgIGlmIGl0ZW1bJ3Bvc3RlciddID09ICcwJzogcmFpc2UgRXhjZXB0aW9uKCkKICAgICAgICAgICAgICAgIHNlbGYubGlzdC5hcHBlbmQoaXRlbSkKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICBwYXNzCgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICB1cmwgPSBzZWxmLnR2ZGJfaW5mb19saW5rICUgKGlbJ3R2ZGInXSwgbGFuZykKICAgICAgICAgICAgICAgIGRhdGEgPSB1cmxsaWIyLnVybG9wZW4odXJsLCB0aW1lb3V0PTEwKS5yZWFkKCkKCiAgICAgICAgICAgICAgICB6aXAgPSB6aXBmaWxlLlppcEZpbGUoU3RyaW5nSU8uU3RyaW5nSU8oZGF0YSkpCiAgICAgICAgICAgICAgICByZXN1bHQgPSB6aXAucmVhZCgnJXMueG1sJyAlIGxhbmcpCiAgICAgICAgICAgICAgICBhcnR3b3JrID0gemlwLnJlYWQoJ2Jhbm5lcnMueG1sJykKICAgICAgICAgICAgICAgIHppcC5jbG9zZSgpCgogICAgICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0LnNwbGl0KCc8RXBpc29kZT4nKQogICAgICAgICAgICAgICAgaXRlbSA9IFsocmUuZmluZGFsbCgnPFNlYXNvbk51bWJlcj4lMDFkPC9TZWFzb25OdW1iZXI+JyAlIGludChpWydzZWFzb24nXSksIHgpLCByZS5maW5kYWxsKCc8RXBpc29kZU51bWJlcj4lMDFkPC9FcGlzb2RlTnVtYmVyPicgJSBpbnQoaVsnZXBpc29kZSddKSwgeCksIHgpIGZvciB4IGluIHJlc3VsdF0KICAgICAgICAgICAgICAgIGl0ZW0gPSBbeFsyXSBmb3IgeCBpbiBpdGVtIGlmIGxlbih4WzBdKSA+IDAgYW5kIGxlbih4WzFdKSA+IDBdWzBdCiAgICAgICAgICAgICAgICBpdGVtMiA9IHJlc3VsdFswXQoKICAgICAgICAgICAgICAgIHByZW1pZXJlZCA9IGNsaWVudC5wYXJzZURPTShpdGVtLCAnRmlyc3RBaXJlZCcpWzBdCiAgICAgICAgICAgICAgICBpZiBwcmVtaWVyZWQgPT0gJycgb3IgJy0wMCcgaW4gcHJlbWllcmVkOiBwcmVtaWVyZWQgPSAnMCcKICAgICAgICAgICAgICAgIHByZW1pZXJlZCA9IGNsaWVudC5yZXBsYWNlSFRNTENvZGVzKHByZW1pZXJlZCkKICAgICAgICAgICAgICAgIHByZW1pZXJlZCA9IHByZW1pZXJlZC5lbmNvZGUoJ3V0Zi04JykKCiAgICAgICAgICAgICAgICB0cnk6IHN0YXR1cyA9IGNsaWVudC5wYXJzZURPTShpdGVtMiwgJ1N0YXR1cycpWzBdCiAgICAgICAgICAgICAgICBleGNlcHQ6IHN0YXR1cyA9ICcnCiAgICAgICAgICAgICAgICBpZiBzdGF0dXMgPT0gJyc6IHN0YXR1cyA9ICdFbmRlZCcKICAgICAgICAgICAgICAgIHN0YXR1cyA9IGNsaWVudC5yZXBsYWNlSFRNTENvZGVzKHN0YXR1cykKICAgICAgICAgICAgICAgIHN0YXR1cyA9IHN0YXR1cy5lbmNvZGUoJ3V0Zi04JykKCiAgICAgICAgICAgICAgICB0aXRsZSA9IGNsaWVudC5wYXJzZURPTShpdGVtLCAnRXBpc29kZU5hbWUnKVswXQogICAgICAgICAgICAgICAgaWYgdGl0bGUgPT0gJyc6IHRpdGxlID0gJzAnCiAgICAgICAgICAgICAgICB0aXRsZSA9IGNsaWVudC5yZXBsYWNlSFRNTENvZGVzKHRpdGxlKQogICAgICAgICAgICAgICAgdGl0bGUgPSB0aXRsZS5lbmNvZGUoJ3V0Zi04JykKCiAgICAgICAgICAgICAgICBzZWFzb24gPSBjbGllbnQucGFyc2VET00oaXRlbSwgJ1NlYXNvbk51bWJlcicpWzBdCiAgICAgICAgICAgICAgICBzZWFzb24gPSAnJTAxZCcgJSBpbnQoc2Vhc29uKQogICAgICAgICAgICAgICAgc2Vhc29uID0gc2Vhc29uLmVuY29kZSgndXRmLTgnKQoKICAgICAgICAgICAgICAgIGVwaXNvZGUgPSBjbGllbnQucGFyc2VET00oaXRlbSwgJ0VwaXNvZGVOdW1iZXInKVswXQogICAgICAgICAgICAgICAgZXBpc29kZSA9IHJlLnN1YignW14wLTldJywgJycsICclMDFkJyAlIGludChlcGlzb2RlKSkKICAgICAgICAgICAgICAgIGVwaXNvZGUgPSBlcGlzb2RlLmVuY29kZSgndXRmLTgnKQoKICAgICAgICAgICAgICAgIHR2c2hvd3RpdGxlID0gaVsndHZzaG93dGl0bGUnXQogICAgICAgICAgICAgICAgaW1kYiwgdHZkYiA9IGlbJ2ltZGInXSwgaVsndHZkYiddCgogICAgICAgICAgICAgICAgeWVhciA9IGlbJ3llYXInXQogICAgICAgICAgICAgICAgdHJ5OiB5ZWFyID0geWVhci5lbmNvZGUoJ3V0Zi04JykKICAgICAgICAgICAgICAgIGV4Y2VwdDogcGFzcwoKICAgICAgICAgICAgICAgIHRyeTogcG9zdGVyID0gY2xpZW50LnBhcnNlRE9NKGl0ZW0yLCAncG9zdGVyJylbMF0KICAgICAgICAgICAgICAgIGV4Y2VwdDogcG9zdGVyID0gJycKICAgICAgICAgICAgICAgIGlmIG5vdCBwb3N0ZXIgPT0gJyc6IHBvc3RlciA9IHNlbGYudHZkYl9pbWFnZSArIHBvc3RlcgogICAgICAgICAgICAgICAgZWxzZTogcG9zdGVyID0gJzAnCiAgICAgICAgICAgICAgICBwb3N0ZXIgPSBjbGllbnQucmVwbGFjZUhUTUxDb2Rlcyhwb3N0ZXIpCiAgICAgICAgICAgICAgICBwb3N0ZXIgPSBwb3N0ZXIuZW5jb2RlKCd1dGYtOCcpCgogICAgICAgICAgICAgICAgdHJ5OiBiYW5uZXIgPSBjbGllbnQucGFyc2VET00oaXRlbTIsICdiYW5uZXInKVswXQogICAgICAgICAgICAgICAgZXhjZXB0OiBiYW5uZXIgPSAnJwogICAgICAgICAgICAgICAgaWYgbm90IGJhbm5lciA9PSAnJzogYmFubmVyID0gc2VsZi50dmRiX2ltYWdlICsgYmFubmVyCiAgICAgICAgICAgICAgICBlbHNlOiBiYW5uZXIgPSAnMCcKICAgICAgICAgICAgICAgIGJhbm5lciA9IGNsaWVudC5yZXBsYWNlSFRNTENvZGVzKGJhbm5lcikKICAgICAgICAgICAgICAgIGJhbm5lciA9IGJhbm5lci5lbmNvZGUoJ3V0Zi04JykKCiAgICAgICAgICAgICAgICB0cnk6IGZhbmFydCA9IGNsaWVudC5wYXJzZURPTShpdGVtMiwgJ2ZhbmFydCcpWzBdCiAgICAgICAgICAgICAgICBleGNlcHQ6IGZhbmFydCA9ICcnCiAgICAgICAgICAgICAgICBpZiBub3QgZmFuYXJ0ID09ICcnOiBmYW5hcnQgPSBzZWxmLnR2ZGJfaW1hZ2UgKyBmYW5hcnQKICAgICAgICAgICAgICAgIGVsc2U6IGZhbmFydCA9ICcwJwogICAgICAgICAgICAgICAgZmFuYXJ0ID0gY2xpZW50LnJlcGxhY2VIVE1MQ29kZXMoZmFuYXJ0KQogICAgICAgICAgICAgICAgZmFuYXJ0ID0gZmFuYXJ0LmVuY29kZSgndXRmLTgnKQoKICAgICAgICAgICAgICAgIHRyeTogdGh1bWIgPSBjbGllbnQucGFyc2VET00oaXRlbSwgJ2ZpbGVuYW1lJylbMF0KICAgICAgICAgICAgICAgIGV4Y2VwdDogdGh1bWIgPSAnJwogICAgICAgICAgICAgICAgaWYgbm90IHRodW1iID09ICcnOiB0aHVtYiA9IHNlbGYudHZkYl9pbWFnZSArIHRodW1iCiAgICAgICAgICAgICAgICBlbHNlOiB0aHVtYiA9ICcwJwogICAgICAgICAgICAgICAgdGh1bWIgPSBjbGllbnQucmVwbGFjZUhUTUxDb2Rlcyh0aHVtYikKICAgICAgICAgICAgICAgIHRodW1iID0gdGh1bWIuZW5jb2RlKCd1dGYtOCcpCgogICAgICAgICAgICAgICAgaWYgbm90IHBvc3RlciA9PSAnMCc6IHBhc3MKICAgICAgICAgICAgICAgIGVsaWYgbm90IGZhbmFydCA9PSAnMCc6IHBvc3RlciA9IGZhbmFydAogICAgICAgICAgICAgICAgZWxpZiBub3QgYmFubmVyID09ICcwJzogcG9zdGVyID0gYmFubmVyCgogICAgICAgICAgICAgICAgaWYgbm90IGJhbm5lciA9PSAnMCc6IHBhc3MKICAgICAgICAgICAgICAgIGVsaWYgbm90IGZhbmFydCA9PSAnMCc6IGJhbm5lciA9IGZhbmFydAogICAgICAgICAgICAgICAgZWxpZiBub3QgcG9zdGVyID09ICcwJzogYmFubmVyID0gcG9zdGVyCgogICAgICAgICAgICAgICAgaWYgbm90IHRodW1iID09ICcwJzogcGFzcwogICAgICAgICAgICAgICAgZWxpZiBub3QgZmFuYXJ0ID09ICcwJzogdGh1bWIgPSBmYW5hcnQucmVwbGFjZShzZWxmLnR2ZGJfaW1hZ2UsIHNlbGYudHZkYl9wb3N0ZXIpCiAgICAgICAgICAgICAgICBlbGlmIG5vdCBwb3N0ZXIgPT0gJzAnOiB0aHVtYiA9IHBvc3RlcgoKICAgICAgICAgICAgICAgIHRyeTogc3R1ZGlvID0gY2xpZW50LnBhcnNlRE9NKGl0ZW0yLCAnTmV0d29yaycpWzBdCiAgICAgICAgICAgICAgICBleGNlcHQ6IHN0dWRpbyA9ICcnCiAgICAgICAgICAgICAgICBpZiBzdHVkaW8gPT0gJyc6IHN0dWRpbyA9ICcwJwogICAgICAgICAgICAgICAgc3R1ZGlvID0gY2xpZW50LnJlcGxhY2VIVE1MQ29kZXMoc3R1ZGlvKQogICAgICAgICAgICAgICAgc3R1ZGlvID0gc3R1ZGlvLmVuY29kZSgndXRmLTgnKQoKICAgICAgICAgICAgICAgIHRyeTogZ2VucmUgPSBjbGllbnQucGFyc2VET00oaXRlbTIsICdHZW5yZScpWzBdCiAgICAgICAgICAgICAgICBleGNlcHQ6IGdlbnJlID0gJycKICAgICAgICAgICAgICAgIGdlbnJlID0gW3ggZm9yIHggaW4gZ2VucmUuc3BsaXQoJ3wnKSBpZiBub3QgeCA9PSAnJ10KICAgICAgICAgICAgICAgIGdlbnJlID0gJyAvICcuam9pbihnZW5yZSkKICAgICAgICAgICAgICAgIGlmIGdlbnJlID09ICcnOiBnZW5yZSA9ICcwJwogICAgICAgICAgICAgICAgZ2VucmUgPSBjbGllbnQucmVwbGFjZUhUTUxDb2RlcyhnZW5yZSkKICAgICAgICAgICAgICAgIGdlbnJlID0gZ2VucmUuZW5jb2RlKCd1dGYtOCcpCgogICAgICAgICAgICAgICAgdHJ5OiBkdXJhdGlvbiA9IGNsaWVudC5wYXJzZURPTShpdGVtMiwgJ1J1bnRpbWUnKVswXQogICAgICAgICAgICAgICAgZXhjZXB0OiBkdXJhdGlvbiA9ICcnCiAgICAgICAgICAgICAgICBpZiBkdXJhdGlvbiA9PSAnJzogZHVyYXRpb24gPSAnMCcKICAgICAgICAgICAgICAgIGR1cmF0aW9uID0gY2xpZW50LnJlcGxhY2VIVE1MQ29kZXMoZHVyYXRpb24pCiAgICAgICAgICAgICAgICBkdXJhdGlvbiA9IGR1cmF0aW9uLmVuY29kZSgndXRmLTgnKQoKICAgICAgICAgICAgICAgIHRyeTogcmF0aW5nID0gY2xpZW50LnBhcnNlRE9NKGl0ZW0sICdSYXRpbmcnKVswXQogICAgICAgICAgICAgICAgZXhjZXB0OiByYXRpbmcgPSAnJwogICAgICAgICAgICAgICAgaWYgcmF0aW5nID09ICcnOiByYXRpbmcgPSAnMCcKICAgICAgICAgICAgICAgIHJhdGluZyA9IGNsaWVudC5yZXBsYWNlSFRNTENvZGVzKHJhdGluZykKICAgICAgICAgICAgICAgIHJhdGluZyA9IHJhdGluZy5lbmNvZGUoJ3V0Zi04JykKCiAgICAgICAgICAgICAgICB0cnk6IHZvdGVzID0gY2xpZW50LnBhcnNlRE9NKGl0ZW0yLCAnUmF0aW5nQ291bnQnKVswXQogICAgICAgICAgICAgICAgZXhjZXB0OiB2b3RlcyA9ICcwJwogICAgICAgICAgICAgICAgaWYgdm90ZXMgPT0gJyc6IHZvdGVzID0gJzAnCiAgICAgICAgICAgICAgICB2b3RlcyA9IGNsaWVudC5yZXBsYWNlSFRNTENvZGVzKHZvdGVzKQogICAgICAgICAgICAgICAgdm90ZXMgPSB2b3Rlcy5lbmNvZGUoJ3V0Zi04JykKCiAgICAgICAgICAgICAgICB0cnk6IG1wYWEgPSBjbGllbnQucGFyc2VET00oaXRlbTIsICdDb250ZW50UmF0aW5nJylbMF0KICAgICAgICAgICAgICAgIGV4Y2VwdDogbXBhYSA9ICcnCiAgICAgICAgICAgICAgICBpZiBtcGFhID09ICcnOiBtcGFhID0gJzAnCiAgICAgICAgICAgICAgICBtcGFhID0gY2xpZW50LnJlcGxhY2VIVE1MQ29kZXMobXBhYSkKICAgICAgICAgICAgICAgIG1wYWEgPSBtcGFhLmVuY29kZSgndXRmLTgnKQoKICAgICAgICAgICAgICAgIHRyeTogZGlyZWN0b3IgPSBjbGllbnQucGFyc2VET00oaXRlbSwgJ0RpcmVjdG9yJylbMF0KICAgICAgICAgICAgICAgIGV4Y2VwdDogZGlyZWN0b3IgPSAnJwogICAgICAgICAgICAgICAgZGlyZWN0b3IgPSBbeCBmb3IgeCBpbiBkaXJlY3Rvci5zcGxpdCgnfCcpIGlmIG5vdCB4ID09ICcnXQogICAgICAgICAgICAgICAgZGlyZWN0b3IgPSAnIC8gJy5qb2luKGRpcmVjdG9yKQogICAgICAgICAgICAgICAgaWYgZGlyZWN0b3IgPT0gJyc6IGRpcmVjdG9yID0gJzAnCiAgICAgICAgICAgICAgICBkaXJlY3RvciA9IGNsaWVudC5yZXBsYWNlSFRNTENvZGVzKGRpcmVjdG9yKQogICAgICAgICAgICAgICAgZGlyZWN0b3IgPSBkaXJlY3Rvci5lbmNvZGUoJ3V0Zi04JykKCiAgICAgICAgICAgICAgICB0cnk6IHdyaXRlciA9IGNsaWVudC5wYXJzZURPTShpdGVtLCAnV3JpdGVyJylbMF0KICAgICAgICAgICAgICAgIGV4Y2VwdDogd3JpdGVyID0gJycKICAgICAgICAgICAgICAgIHdyaXRlciA9IFt4IGZvciB4IGluIHdyaXRlci5zcGxpdCgnfCcpIGlmIG5vdCB4ID09ICcnXQogICAgICAgICAgICAgICAgd3JpdGVyID0gJyAvICcuam9pbih3cml0ZXIpCiAgICAgICAgICAgICAgICBpZiB3cml0ZXIgPT0gJyc6IHdyaXRlciA9ICcwJwogICAgICAgICAgICAgICAgd3JpdGVyID0gY2xpZW50LnJlcGxhY2VIVE1MQ29kZXMod3JpdGVyKQogICAgICAgICAgICAgICAgd3JpdGVyID0gd3JpdGVyLmVuY29kZSgndXRmLTgnKQoKICAgICAgICAgICAgICAgIHRyeTogY2FzdCA9IGNsaWVudC5wYXJzZURPTShpdGVtMiwgJ0FjdG9ycycpWzBdCiAgICAgICAgICAgICAgICBleGNlcHQ6IGNhc3QgPSAnJwogICAgICAgICAgICAgICAgY2FzdCA9IFt4IGZvciB4IGluIGNhc3Quc3BsaXQoJ3wnKSBpZiBub3QgeCA9PSAnJ10KICAgICAgICAgICAgICAgIHRyeTogY2FzdCA9IFsoeC5lbmNvZGUoJ3V0Zi04JyksICcnKSBmb3IgeCBpbiBjYXN0XQogICAgICAgICAgICAgICAgZXhjZXB0OiBjYXN0ID0gW10KCiAgICAgICAgICAgICAgICB0cnk6IHBsb3QgPSBjbGllbnQucGFyc2VET00oaXRlbSwgJ092ZXJ2aWV3JylbMF0KICAgICAgICAgICAgICAgIGV4Y2VwdDogcGxvdCA9ICcnCiAgICAgICAgICAgICAgICBpZiBwbG90ID09ICcnOgogICAgICAgICAgICAgICAgICAgIHRyeTogcGxvdCA9IGNsaWVudC5wYXJzZURPTShpdGVtMiwgJ092ZXJ2aWV3JylbMF0KICAgICAgICAgICAgICAgICAgICBleGNlcHQ6IHBsb3QgPSAnJwogICAgICAgICAgICAgICAgaWYgcGxvdCA9PSAnJzogcGxvdCA9ICcwJwogICAgICAgICAgICAgICAgcGxvdCA9IGNsaWVudC5yZXBsYWNlSFRNTENvZGVzKHBsb3QpCiAgICAgICAgICAgICAgICBwbG90ID0gcGxvdC5lbmNvZGUoJ3V0Zi04JykKCiAgICAgICAgICAgICAgICBzZWxmLmxpc3QuYXBwZW5kKHsndGl0bGUnOiB0aXRsZSwgJ3NlYXNvbic6IHNlYXNvbiwgJ2VwaXNvZGUnOiBlcGlzb2RlLCAndHZzaG93dGl0bGUnOiB0dnNob3d0aXRsZSwgJ3llYXInOiB5ZWFyLCAncHJlbWllcmVkJzogcHJlbWllcmVkLCAnc3RhdHVzJzogc3RhdHVzLCAnc3R1ZGlvJzogc3R1ZGlvLCAnZ2VucmUnOiBnZW5yZSwgJ2R1cmF0aW9uJzogZHVyYXRpb24sICdyYXRpbmcnOiByYXRpbmcsICd2b3Rlcyc6IHZvdGVzLCAnbXBhYSc6IG1wYWEsICdkaXJlY3Rvcic6IGRpcmVjdG9yLCAnd3JpdGVyJzogd3JpdGVyLCAnY2FzdCc6IGNhc3QsICdwbG90JzogcGxvdCwgJ2ltZGInOiBpbWRiLCAndHZkYic6IHR2ZGIsICdwb3N0ZXInOiBwb3N0ZXIsICdiYW5uZXInOiBiYW5uZXIsICdmYW5hcnQnOiBmYW5hcnQsICd0aHVtYic6IHRodW1ifSkKICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgcGFzcwoKCiAgICAgICAgaXRlbXMgPSBpdGVtc1s6MTAwXQoKICAgICAgICB0aHJlYWRzID0gW10KICAgICAgICBmb3IgaSBpbiBpdGVtczogdGhyZWFkcy5hcHBlbmQod29ya2Vycy5UaHJlYWQoaXRlbXNfbGlzdCwgaSkpCiAgICAgICAgW2kuc3RhcnQoKSBmb3IgaSBpbiB0aHJlYWRzXQogICAgICAgIFtpLmpvaW4oKSBmb3IgaSBpbiB0aHJlYWRzXQoKICAgICAgICByZXR1cm4gc2VsZi5saXN0CgoKICAgIGRlZiB0cmFrdF91c2VyX2xpc3Qoc2VsZiwgdXJsLCB1c2VyKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIGl0ZW1zID0gdHJha3QuZ2V0VHJha3RBc0pzb24odXJsKQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcGFzcwoKICAgICAgICBmb3IgaXRlbSBpbiBpdGVtczoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgdHJ5OiBuYW1lID0gaXRlbVsnbGlzdCddWyduYW1lJ10KICAgICAgICAgICAgICAgIGV4Y2VwdDogbmFtZSA9IGl0ZW1bJ25hbWUnXQogICAgICAgICAgICAgICAgbmFtZSA9IGNsaWVudC5yZXBsYWNlSFRNTENvZGVzKG5hbWUpCgogICAgICAgICAgICAgICAgdHJ5OiB1cmwgPSAodHJha3Quc2x1ZyhpdGVtWydsaXN0J11bJ3VzZXInXVsndXNlcm5hbWUnXSksIGl0ZW1bJ2xpc3QnXVsnaWRzJ11bJ3NsdWcnXSkKICAgICAgICAgICAgICAgIGV4Y2VwdDogdXJsID0gKCdtZScsIGl0ZW1bJ2lkcyddWydzbHVnJ10pCiAgICAgICAgICAgICAgICB1cmwgPSBzZWxmLnRyYWt0bGlzdF9saW5rICUgdXJsCiAgICAgICAgICAgICAgICB1cmwgPSB1cmwuZW5jb2RlKCd1dGYtOCcpCgogICAgICAgICAgICAgICAgc2VsZi5saXN0LmFwcGVuZCh7J25hbWUnOiBuYW1lLCAndXJsJzogdXJsLCAnY29udGV4dCc6IHVybH0pCiAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgICAgICAgICBzZWxmLmxpc3QgPSBzb3J0ZWQoc2VsZi5saXN0LCBrZXk9bGFtYmRhIGs6IHV0aWxzLnRpdGxlX2tleShrWyduYW1lJ10pKQogICAgICAgIHJldHVybiBzZWxmLmxpc3QKCgogICAgZGVmIHR2bWF6ZV9saXN0KHNlbGYsIHVybCwgbGltaXQpOgogICAgICAgIHRyeToKICAgICAgICAgICAgcmVzdWx0ID0gY2xpZW50LnJlcXVlc3QodXJsKQoKICAgICAgICAgICAgaXRlbWxpc3QgPSBbXQogICAgICAgICAgICBpdGVtcyA9IGpzb24ubG9hZHMocmVzdWx0KQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIGZvciBpdGVtIGluIGl0ZW1zOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBpZiBub3QgJ2VuZ2xpc2gnIGluIGl0ZW1bJ3Nob3cnXVsnbGFuZ3VhZ2UnXS5sb3dlcigpOiByYWlzZSBFeGNlcHRpb24oKQoKICAgICAgICAgICAgICAgIGlmIGxpbWl0ID09IFRydWUgYW5kIG5vdCAnc2NyaXB0ZWQnIGluIGl0ZW1bJ3Nob3cnXVsndHlwZSddLmxvd2VyKCk6IHJhaXNlIEV4Y2VwdGlvbigpCgogICAgICAgICAgICAgICAgdGl0bGUgPSBpdGVtWyduYW1lJ10KICAgICAgICAgICAgICAgIGlmIHRpdGxlID09IE5vbmUgb3IgdGl0bGUgPT0gJyc6IHJhaXNlIEV4Y2VwdGlvbigpCiAgICAgICAgICAgICAgICB0aXRsZSA9IGNsaWVudC5yZXBsYWNlSFRNTENvZGVzKHRpdGxlKQogICAgICAgICAgICAgICAgdGl0bGUgPSB0aXRsZS5lbmNvZGUoJ3V0Zi04JykKCiAgICAgICAgICAgICAgICBzZWFzb24gPSBpdGVtWydzZWFzb24nXQogICAgICAgICAgICAgICAgc2Vhc29uID0gcmUuc3ViKCdbXjAtOV0nLCAnJywgJyUwMWQnICUgaW50KHNlYXNvbikpCiAgICAgICAgICAgICAgICBpZiBzZWFzb24gPT0gJzAnOiByYWlzZSBFeGNlcHRpb24oKQogICAgICAgICAgICAgICAgc2Vhc29uID0gc2Vhc29uLmVuY29kZSgndXRmLTgnKQoKICAgICAgICAgICAgICAgIGVwaXNvZGUgPSBpdGVtWydudW1iZXInXQogICAgICAgICAgICAgICAgZXBpc29kZSA9IHJlLnN1YignW14wLTldJywgJycsICclMDFkJyAlIGludChlcGlzb2RlKSkKICAgICAgICAgICAgICAgIGlmIGVwaXNvZGUgPT0gJzAnOiByYWlzZSBFeGNlcHRpb24oKQogICAgICAgICAgICAgICAgZXBpc29kZSA9IGVwaXNvZGUuZW5jb2RlKCd1dGYtOCcpCgogICAgICAgICAgICAgICAgdHZzaG93dGl0bGUgPSBpdGVtWydzaG93J11bJ25hbWUnXQogICAgICAgICAgICAgICAgaWYgdHZzaG93dGl0bGUgPT0gTm9uZSBvciB0dnNob3d0aXRsZSA9PSAnJzogcmFpc2UgRXhjZXB0aW9uKCkKICAgICAgICAgICAgICAgIHR2c2hvd3RpdGxlID0gY2xpZW50LnJlcGxhY2VIVE1MQ29kZXModHZzaG93dGl0bGUpCiAgICAgICAgICAgICAgICB0dnNob3d0aXRsZSA9IHR2c2hvd3RpdGxlLmVuY29kZSgndXRmLTgnKQoKICAgICAgICAgICAgICAgIHllYXIgPSBpdGVtWydzaG93J11bJ3ByZW1pZXJlZCddCiAgICAgICAgICAgICAgICB5ZWFyID0gcmUuZmluZGFsbCgnKFxkezR9KScsIHllYXIpWzBdCiAgICAgICAgICAgICAgICB5ZWFyID0geWVhci5lbmNvZGUoJ3V0Zi04JykKCiAgICAgICAgICAgICAgICBpbWRiID0gaXRlbVsnc2hvdyddWydleHRlcm5hbHMnXVsnaW1kYiddCiAgICAgICAgICAgICAgICBpZiBpbWRiID09IE5vbmUgb3IgaW1kYiA9PSAnJzogaW1kYiA9ICcwJwogICAgICAgICAgICAgICAgZWxzZTogaW1kYiA9ICd0dCcgKyByZS5zdWIoJ1teMC05XScsICcnLCBzdHIoaW1kYikpCiAgICAgICAgICAgICAgICBpbWRiID0gaW1kYi5lbmNvZGUoJ3V0Zi04JykKCiAgICAgICAgICAgICAgICB0dmRiID0gaXRlbVsnc2hvdyddWydleHRlcm5hbHMnXVsndGhldHZkYiddCiAgICAgICAgICAgICAgICBpZiB0dmRiID09IE5vbmUgb3IgdHZkYiA9PSAnJzogcmFpc2UgRXhjZXB0aW9uKCkKICAgICAgICAgICAgICAgIHR2ZGIgPSByZS5zdWIoJ1teMC05XScsICcnLCBzdHIodHZkYikpCiAgICAgICAgICAgICAgICB0dmRiID0gdHZkYi5lbmNvZGUoJ3V0Zi04JykKCiAgICAgICAgICAgICAgICBwb3N0ZXIgPSAnMCcKICAgICAgICAgICAgICAgIHRyeTogcG9zdGVyID0gaXRlbVsnc2hvdyddWydpbWFnZSddWydvcmlnaW5hbCddCiAgICAgICAgICAgICAgICBleGNlcHQ6IHBvc3RlciA9ICcwJwogICAgICAgICAgICAgICAgaWYgcG9zdGVyID09IE5vbmUgb3IgcG9zdGVyID09ICcnOiBwb3N0ZXIgPSAnMCcKICAgICAgICAgICAgICAgIHBvc3RlciA9IHBvc3Rlci5lbmNvZGUoJ3V0Zi04JykKCiAgICAgICAgICAgICAgICB0cnk6IHRodW1iMSA9IGl0ZW1bJ3Nob3cnXVsnaW1hZ2UnXVsnb3JpZ2luYWwnXQogICAgICAgICAgICAgICAgZXhjZXB0OiB0aHVtYjEgPSAnMCcKICAgICAgICAgICAgICAgIHRyeTogdGh1bWIyID0gaXRlbVsnaW1hZ2UnXVsnb3JpZ2luYWwnXQogICAgICAgICAgICAgICAgZXhjZXB0OiB0aHVtYjIgPSAnMCcKICAgICAgICAgICAgICAgIGlmIHRodW1iMiA9PSBOb25lIG9yIHRodW1iMiA9PSAnMCc6IHRodW1iID0gdGh1bWIxCiAgICAgICAgICAgICAgICBlbHNlOiB0aHVtYiA9IHRodW1iMgogICAgICAgICAgICAgICAgaWYgdGh1bWIgPT0gTm9uZSBvciB0aHVtYiA9PSAnJzogdGh1bWIgPSAnMCcKICAgICAgICAgICAgICAgIHRodW1iID0gdGh1bWIuZW5jb2RlKCd1dGYtOCcpCgogICAgICAgICAgICAgICAgcHJlbWllcmVkID0gaXRlbVsnYWlyZGF0ZSddCiAgICAgICAgICAgICAgICB0cnk6IHByZW1pZXJlZCA9IHJlLmZpbmRhbGwoJyhcZHs0fS1cZHsyfS1cZHsyfSknLCBwcmVtaWVyZWQpWzBdCiAgICAgICAgICAgICAgICBleGNlcHQ6IHByZW1pZXJlZCA9ICcwJwogICAgICAgICAgICAgICAgcHJlbWllcmVkID0gcHJlbWllcmVkLmVuY29kZSgndXRmLTgnKQoKICAgICAgICAgICAgICAgIHRyeTogc3R1ZGlvID0gaXRlbVsnc2hvdyddWyduZXR3b3JrJ11bJ25hbWUnXQogICAgICAgICAgICAgICAgZXhjZXB0OiBzdHVkaW8gPSAnMCcKICAgICAgICAgICAgICAgIGlmIHN0dWRpbyA9PSBOb25lOiBzdHVkaW8gPSAnMCcKICAgICAgICAgICAgICAgIHN0dWRpbyA9IHN0dWRpby5lbmNvZGUoJ3V0Zi04JykKCiAgICAgICAgICAgICAgICB0cnk6IGdlbnJlID0gaXRlbVsnc2hvdyddWydnZW5yZXMnXQogICAgICAgICAgICAgICAgZXhjZXB0OiBnZW5yZSA9ICcwJwogICAgICAgICAgICAgICAgZ2VucmUgPSBbaS50aXRsZSgpIGZvciBpIGluIGdlbnJlXQogICAgICAgICAgICAgICAgaWYgZ2VucmUgPT0gW106IGdlbnJlID0gJzAnCiAgICAgICAgICAgICAgICBnZW5yZSA9ICcgLyAnLmpvaW4oZ2VucmUpCiAgICAgICAgICAgICAgICBnZW5yZSA9IGdlbnJlLmVuY29kZSgndXRmLTgnKQoKICAgICAgICAgICAgICAgIHRyeTogZHVyYXRpb24gPSBpdGVtWydzaG93J11bJ3J1bnRpbWUnXQogICAgICAgICAgICAgICAgZXhjZXB0OiBkdXJhdGlvbiA9ICcwJwogICAgICAgICAgICAgICAgaWYgZHVyYXRpb24gPT0gTm9uZTogZHVyYXRpb24gPSAnMCcKICAgICAgICAgICAgICAgIGR1cmF0aW9uID0gc3RyKGR1cmF0aW9uKQogICAgICAgICAgICAgICAgZHVyYXRpb24gPSBkdXJhdGlvbi5lbmNvZGUoJ3V0Zi04JykKCiAgICAgICAgICAgICAgICB0cnk6IHJhdGluZyA9IGl0ZW1bJ3Nob3cnXVsncmF0aW5nJ11bJ2F2ZXJhZ2UnXQogICAgICAgICAgICAgICAgZXhjZXB0OiByYXRpbmcgPSAnMCcKICAgICAgICAgICAgICAgIGlmIHJhdGluZyA9PSBOb25lIG9yIHJhdGluZyA9PSAnMC4wJzogcmF0aW5nID0gJzAnCiAgICAgICAgICAgICAgICByYXRpbmcgPSBzdHIocmF0aW5nKQogICAgICAgICAgICAgICAgcmF0aW5nID0gcmF0aW5nLmVuY29kZSgndXRmLTgnKQoKICAgICAgICAgICAgICAgIHRyeTogcGxvdCA9IGl0ZW1bJ3Nob3cnXVsnc3VtbWFyeSddCiAgICAgICAgICAgICAgICBleGNlcHQ6IHBsb3QgPSAnMCcKICAgICAgICAgICAgICAgIGlmIHBsb3QgPT0gTm9uZTogcGxvdCA9ICcwJwogICAgICAgICAgICAgICAgcGxvdCA9IHJlLnN1YignPC4rPz58PC8uKz8+fFxuJywgJycsIHBsb3QpCiAgICAgICAgICAgICAgICBwbG90ID0gY2xpZW50LnJlcGxhY2VIVE1MQ29kZXMocGxvdCkKICAgICAgICAgICAgICAgIHBsb3QgPSBwbG90LmVuY29kZSgndXRmLTgnKQoKICAgICAgICAgICAgICAgIGl0ZW1saXN0LmFwcGVuZCh7J3RpdGxlJzogdGl0bGUsICdzZWFzb24nOiBzZWFzb24sICdlcGlzb2RlJzogZXBpc29kZSwgJ3R2c2hvd3RpdGxlJzogdHZzaG93dGl0bGUsICd5ZWFyJzogeWVhciwgJ3ByZW1pZXJlZCc6IHByZW1pZXJlZCwgJ3N0YXR1cyc6ICdDb250aW51aW5nJywgJ3N0dWRpbyc6IHN0dWRpbywgJ2dlbnJlJzogZ2VucmUsICdkdXJhdGlvbic6IGR1cmF0aW9uLCAncmF0aW5nJzogcmF0aW5nLCAncGxvdCc6IHBsb3QsICdpbWRiJzogaW1kYiwgJ3R2ZGInOiB0dmRiLCAncG9zdGVyJzogcG9zdGVyLCAndGh1bWInOiB0aHVtYn0pCiAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgaXRlbWxpc3QgPSBpdGVtbGlzdFs6Oi0xXQoKICAgICAgICByZXR1cm4gaXRlbWxpc3QKCgogICAgZGVmIGVwaXNvZGVEaXJlY3Rvcnkoc2VsZiwgaXRlbXMpOgogICAgICAgIGlmIGl0ZW1zID09IE5vbmUgb3IgbGVuKGl0ZW1zKSA9PSAwOiBjb250cm9sLmlkbGUoKSA7IHN5cy5leGl0KCkKCiAgICAgICAgc3lzYWRkb24gPSBzeXMuYXJndlswXQoKICAgICAgICBzeXNoYW5kbGUgPSBpbnQoc3lzLmFyZ3ZbMV0pCgogICAgICAgIGFkZG9uUG9zdGVyLCBhZGRvbkJhbm5lciA9IGNvbnRyb2wuYWRkb25Qb3N0ZXIoKSwgY29udHJvbC5hZGRvbkJhbm5lcigpCgogICAgICAgIGFkZG9uRmFuYXJ0LCBzZXR0aW5nRmFuYXJ0ID0gY29udHJvbC5hZGRvbkZhbmFydCgpLCBjb250cm9sLnNldHRpbmcoJ2ZhbmFydCcpCgogICAgICAgIHRyYWt0Q3JlZGVudGlhbHMgPSB0cmFrdC5nZXRUcmFrdENyZWRlbnRpYWxzSW5mbygpCgogICAgICAgIHRyeTogaXNPbGQgPSBGYWxzZSA7IGNvbnRyb2wuaXRlbSgpLmdldEFydCgndHlwZScpCiAgICAgICAgZXhjZXB0OiBpc09sZCA9IFRydWUKCiAgICAgICAgaXNQbGF5YWJsZSA9ICd0cnVlJyBpZiBub3QgJ3BsdWdpbicgaW4gY29udHJvbC5pbmZvTGFiZWwoJ0NvbnRhaW5lci5QbHVnaW5OYW1lJykgZWxzZSAnZmFsc2UnCgogICAgICAgIGluZGljYXRvcnMgPSBwbGF5Y291bnQuZ2V0VFZTaG93SW5kaWNhdG9ycyhyZWZyZXNoPVRydWUpCgogICAgICAgIHRyeTogbXVsdGkgPSBbaVsndHZzaG93dGl0bGUnXSBmb3IgaSBpbiBpdGVtc10KICAgICAgICBleGNlcHQ6IG11bHRpID0gW10KICAgICAgICBtdWx0aSA9IGxlbihbeCBmb3IgeSx4IGluIGVudW1lcmF0ZShtdWx0aSkgaWYgeCBub3QgaW4gbXVsdGlbOnldXSkKICAgICAgICBtdWx0aSA9IFRydWUgaWYgbXVsdGkgPiAxIGVsc2UgRmFsc2UKCiAgICAgICAgdHJ5OiBzeXNhY3Rpb24gPSBpdGVtc1swXVsnYWN0aW9uJ10KICAgICAgICBleGNlcHQ6IHN5c2FjdGlvbiA9ICcnCgogICAgICAgIGlzRm9sZGVyID0gRmFsc2UgaWYgbm90IHN5c2FjdGlvbiA9PSAnZXBpc29kZXMnIGVsc2UgVHJ1ZQoKICAgICAgICBwbGF5YmFja01lbnUgPSBjb250cm9sLmxhbmcoMzIwNjMpLmVuY29kZSgndXRmLTgnKSBpZiBjb250cm9sLnNldHRpbmcoJ2hvc3RzLm1vZGUnKSA9PSAnMicgZWxzZSBjb250cm9sLmxhbmcoMzIwNjQpLmVuY29kZSgndXRmLTgnKQoKICAgICAgICB3YXRjaGVkTWVudSA9IGNvbnRyb2wubGFuZygzMjA2OCkuZW5jb2RlKCd1dGYtOCcpIGlmIHRyYWt0LmdldFRyYWt0SW5kaWNhdG9yc0luZm8oKSA9PSBUcnVlIGVsc2UgY29udHJvbC5sYW5nKDMyMDY2KS5lbmNvZGUoJ3V0Zi04JykKCiAgICAgICAgdW53YXRjaGVkTWVudSA9IGNvbnRyb2wubGFuZygzMjA2OSkuZW5jb2RlKCd1dGYtOCcpIGlmIHRyYWt0LmdldFRyYWt0SW5kaWNhdG9yc0luZm8oKSA9PSBUcnVlIGVsc2UgY29udHJvbC5sYW5nKDMyMDY3KS5lbmNvZGUoJ3V0Zi04JykKCiAgICAgICAgcXVldWVNZW51ID0gY29udHJvbC5sYW5nKDMyMDY1KS5lbmNvZGUoJ3V0Zi04JykKCiAgICAgICAgdHJha3RNYW5hZ2VyTWVudSA9IGNvbnRyb2wubGFuZygzMjA3MCkuZW5jb2RlKCd1dGYtOCcpCgogICAgICAgIHR2c2hvd0Jyb3dzZXJNZW51ID0gY29udHJvbC5sYW5nKDMyMDcxKS5lbmNvZGUoJ3V0Zi04JykKCiAgICAgICAgYWRkVG9MaWJyYXJ5ID0gY29udHJvbC5sYW5nKDMyNTUxKS5lbmNvZGUoJ3V0Zi04JykKCiAgICAgICAgZm9yIGkgaW4gaXRlbXM6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGlmIG5vdCAnbGFiZWwnIGluIGk6IGlbJ2xhYmVsJ10gPSBpWyd0aXRsZSddCgogICAgICAgICAgICAgICAgaWYgaVsnbGFiZWwnXSA9PSAnMCc6CiAgICAgICAgICAgICAgICAgICAgbGFiZWwgPSAnJXN4JTAyZCAuICVzICVzJyAlIChpWydzZWFzb24nXSwgaW50KGlbJ2VwaXNvZGUnXSksICdFcGlzb2RlJywgaVsnZXBpc29kZSddKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBsYWJlbCA9ICclc3glMDJkIC4gJXMnICUgKGlbJ3NlYXNvbiddLCBpbnQoaVsnZXBpc29kZSddKSwgaVsnbGFiZWwnXSkKICAgICAgICAgICAgICAgIGlmIG11bHRpID09IFRydWU6CiAgICAgICAgICAgICAgICAgICAgbGFiZWwgPSAnJXMgLSAlcycgJSAoaVsndHZzaG93dGl0bGUnXSwgbGFiZWwpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBpZiBpWyd1bmFpcmVkJ10gPT0gJ3RydWUnOgogICAgICAgICAgICAgICAgICAgICAgICBsYWJlbCA9ICdbQ09MT1IgZGFya3JlZF1bSV0lc1svSV1bL0NPTE9SXScgJSBsYWJlbAogICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgICAgICAgICBpbWRiLCB0dmRiLCB5ZWFyLCBzZWFzb24sIGVwaXNvZGUgPSBpWydpbWRiJ10sIGlbJ3R2ZGInXSwgaVsneWVhciddLCBpWydzZWFzb24nXSwgaVsnZXBpc29kZSddCgogICAgICAgICAgICAgICAgc3lzdGl0bGUgPSB1cmxsaWIucXVvdGVfcGx1cyhpWyd0aXRsZSddKQogICAgICAgICAgICAgICAgc3lzdHZzaG93dGl0bGUgPSB1cmxsaWIucXVvdGVfcGx1cyhpWyd0dnNob3d0aXRsZSddKQogICAgICAgICAgICAgICAgc3lzcHJlbWllcmVkID0gdXJsbGliLnF1b3RlX3BsdXMoaVsncHJlbWllcmVkJ10pCgogICAgICAgICAgICAgICAgbWV0YSA9IGRpY3QoKGssdikgZm9yIGssIHYgaW4gaS5pdGVyaXRlbXMoKSBpZiBub3QgdiA9PSAnMCcpCiAgICAgICAgICAgICAgICBtZXRhLnVwZGF0ZSh7J21lZGlhdHlwZSc6ICdlcGlzb2RlJ30pCiAgICAgICAgICAgICAgICBtZXRhLnVwZGF0ZSh7J3RyYWlsZXInOiAnJXM/YWN0aW9uPXRyYWlsZXImbmFtZT0lcycgJSAoc3lzYWRkb24sIHN5c3R2c2hvd3RpdGxlKX0pCiAgICAgICAgICAgICAgICBpZiBub3QgJ2R1cmF0aW9uJyBpbiBpOiBtZXRhLnVwZGF0ZSh7J2R1cmF0aW9uJzogJzYwJ30pCiAgICAgICAgICAgICAgICBlbGlmIGlbJ2R1cmF0aW9uJ10gPT0gJzAnOiBtZXRhLnVwZGF0ZSh7J2R1cmF0aW9uJzogJzYwJ30pCiAgICAgICAgICAgICAgICB0cnk6IG1ldGEudXBkYXRlKHsnZHVyYXRpb24nOiBzdHIoaW50KG1ldGFbJ2R1cmF0aW9uJ10pICogNjApfSkKICAgICAgICAgICAgICAgIGV4Y2VwdDogcGFzcwogICAgICAgICAgICAgICAgdHJ5OiBtZXRhLnVwZGF0ZSh7J2dlbnJlJzogY2xlYW5nZW5yZS5sYW5nKG1ldGFbJ2dlbnJlJ10sIHNlbGYubGFuZyl9KQogICAgICAgICAgICAgICAgZXhjZXB0OiBwYXNzCiAgICAgICAgICAgICAgICB0cnk6IG1ldGEudXBkYXRlKHsneWVhcic6IHJlLmZpbmRhbGwoJyhcZHs0fSknLCBpWydwcmVtaWVyZWQnXSlbMF19KQogICAgICAgICAgICAgICAgZXhjZXB0OiBwYXNzCiAgICAgICAgICAgICAgICB0cnk6IG1ldGEudXBkYXRlKHsndGl0bGUnOiBpWydsYWJlbCddfSkKICAgICAgICAgICAgICAgIGV4Y2VwdDogcGFzcwoKICAgICAgICAgICAgICAgIHN5c21ldGEgPSB1cmxsaWIucXVvdGVfcGx1cyhqc29uLmR1bXBzKG1ldGEpKQoKCiAgICAgICAgICAgICAgICB1cmwgPSAnJXM/YWN0aW9uPXBsYXkmdGl0bGU9JXMmeWVhcj0lcyZpbWRiPSVzJnR2ZGI9JXMmc2Vhc29uPSVzJmVwaXNvZGU9JXMmdHZzaG93dGl0bGU9JXMmcHJlbWllcmVkPSVzJm1ldGE9JXMmdD0lcycgJSAoc3lzYWRkb24sIHN5c3RpdGxlLCB5ZWFyLCBpbWRiLCB0dmRiLCBzZWFzb24sIGVwaXNvZGUsIHN5c3R2c2hvd3RpdGxlLCBzeXNwcmVtaWVyZWQsIHN5c21ldGEsIHNlbGYuc3lzdGltZSkKICAgICAgICAgICAgICAgIHN5c3VybCA9IHVybGxpYi5xdW90ZV9wbHVzKHVybCkKCiAgICAgICAgICAgICAgICBwYXRoID0gJyVzP2FjdGlvbj1wbGF5JnRpdGxlPSVzJnllYXI9JXMmaW1kYj0lcyZ0dmRiPSVzJnNlYXNvbj0lcyZlcGlzb2RlPSVzJnR2c2hvd3RpdGxlPSVzJnByZW1pZXJlZD0lcycgJSAoc3lzYWRkb24sIHN5c3RpdGxlLCB5ZWFyLCBpbWRiLCB0dmRiLCBzZWFzb24sIGVwaXNvZGUsIHN5c3R2c2hvd3RpdGxlLCBzeXNwcmVtaWVyZWQpCgogICAgICAgICAgICAgICAgaWYgaXNGb2xkZXIgPT0gVHJ1ZToKICAgICAgICAgICAgICAgICAgICB1cmwgPSAnJXM/YWN0aW9uPWVwaXNvZGVzJnR2c2hvd3RpdGxlPSVzJnllYXI9JXMmaW1kYj0lcyZ0dmRiPSVzJnNlYXNvbj0lcyZlcGlzb2RlPSVzJyAlIChzeXNhZGRvbiwgc3lzdHZzaG93dGl0bGUsIHllYXIsIGltZGIsIHR2ZGIsIHNlYXNvbiwgZXBpc29kZSkKCgogICAgICAgICAgICAgICAgY20gPSBbXQoKICAgICAgICAgICAgICAgIGNtLmFwcGVuZCgocXVldWVNZW51LCAnUnVuUGx1Z2luKCVzP2FjdGlvbj1xdWV1ZUl0ZW0pJyAlIHN5c2FkZG9uKSkKCiAgICAgICAgICAgICAgICBpZiBtdWx0aSA9PSBUcnVlOgogICAgICAgICAgICAgICAgICAgIGNtLmFwcGVuZCgodHZzaG93QnJvd3Nlck1lbnUsICdDb250YWluZXIuVXBkYXRlKCVzP2FjdGlvbj1zZWFzb25zJnR2c2hvd3RpdGxlPSVzJnllYXI9JXMmaW1kYj0lcyZ0dmRiPSVzLHJldHVybiknICUgKHN5c2FkZG9uLCBzeXN0dnNob3d0aXRsZSwgeWVhciwgaW1kYiwgdHZkYikpKQoKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBvdmVybGF5ID0gaW50KHBsYXljb3VudC5nZXRFcGlzb2RlT3ZlcmxheShpbmRpY2F0b3JzLCBpbWRiLCB0dmRiLCBzZWFzb24sIGVwaXNvZGUpKQogICAgICAgICAgICAgICAgICAgIGlmIG92ZXJsYXkgPT0gNzoKICAgICAgICAgICAgICAgICAgICAgICAgY20uYXBwZW5kKCh1bndhdGNoZWRNZW51LCAnUnVuUGx1Z2luKCVzP2FjdGlvbj1lcGlzb2RlUGxheWNvdW50JmltZGI9JXMmdHZkYj0lcyZzZWFzb249JXMmZXBpc29kZT0lcyZxdWVyeT02KScgJSAoc3lzYWRkb24sIGltZGIsIHR2ZGIsIHNlYXNvbiwgZXBpc29kZSkpKQogICAgICAgICAgICAgICAgICAgICAgICBtZXRhLnVwZGF0ZSh7J3BsYXljb3VudCc6IDEsICdvdmVybGF5JzogN30pCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgY20uYXBwZW5kKCh3YXRjaGVkTWVudSwgJ1J1blBsdWdpbiglcz9hY3Rpb249ZXBpc29kZVBsYXljb3VudCZpbWRiPSVzJnR2ZGI9JXMmc2Vhc29uPSVzJmVwaXNvZGU9JXMmcXVlcnk9NyknICUgKHN5c2FkZG9uLCBpbWRiLCB0dmRiLCBzZWFzb24sIGVwaXNvZGUpKSkKICAgICAgICAgICAgICAgICAgICAgICAgbWV0YS51cGRhdGUoeydwbGF5Y291bnQnOiAwLCAnb3ZlcmxheSc6IDZ9KQogICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgICAgICAgICBpZiB0cmFrdENyZWRlbnRpYWxzID09IFRydWU6CiAgICAgICAgICAgICAgICAgICAgY20uYXBwZW5kKCh0cmFrdE1hbmFnZXJNZW51LCAnUnVuUGx1Z2luKCVzP2FjdGlvbj10cmFrdE1hbmFnZXImbmFtZT0lcyZ0dmRiPSVzJmNvbnRlbnQ9dHZzaG93KScgJSAoc3lzYWRkb24sIHN5c3R2c2hvd3RpdGxlLCB0dmRiKSkpCgogICAgICAgICAgICAgICAgaWYgaXNGb2xkZXIgPT0gRmFsc2U6CiAgICAgICAgICAgICAgICAgICAgY20uYXBwZW5kKChwbGF5YmFja01lbnUsICdSdW5QbHVnaW4oJXM/YWN0aW9uPWFsdGVyU291cmNlcyZ1cmw9JXMmbWV0YT0lcyknICUgKHN5c2FkZG9uLCBzeXN1cmwsIHN5c21ldGEpKSkKCiAgICAgICAgICAgICAgICBpZiBpc09sZCA9PSBUcnVlOgogICAgICAgICAgICAgICAgICAgIGNtLmFwcGVuZCgoY29udHJvbC5sYW5nMigxOTAzMykuZW5jb2RlKCd1dGYtOCcpLCAnQWN0aW9uKEluZm8pJykpCgogICAgICAgICAgICAgICAgY20uYXBwZW5kKChhZGRUb0xpYnJhcnksICdSdW5QbHVnaW4oJXM/YWN0aW9uPXR2c2hvd1RvTGlicmFyeSZ0dnNob3d0aXRsZT0lcyZ5ZWFyPSVzJmltZGI9JXMmdHZkYj0lcyknICUgKHN5c2FkZG9uLCBzeXN0dnNob3d0aXRsZSwgeWVhciwgaW1kYiwgdHZkYikpKQoKICAgICAgICAgICAgICAgIGNtLmFwcGVuZCgoJzEzQ2xvd25zIFNldHRpbmdzJywgJ1J1blBsdWdpbiglcz9hY3Rpb249b3BlblNldHRpbmdzJnF1ZXJ5PSgwLDApKScgJSBzeXNhZGRvbikpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGl0ZW0gPSBjb250cm9sLml0ZW0obGFiZWw9bGFiZWwpCgogICAgICAgICAgICAgICAgYXJ0ID0ge30KCiAgICAgICAgICAgICAgICBpZiAncG9zdGVyJyBpbiBpIGFuZCBub3QgaVsncG9zdGVyJ10gPT0gJzAnOgogICAgICAgICAgICAgICAgICAgIGFydC51cGRhdGUoeydwb3N0ZXInOiBpWydwb3N0ZXInXSwgJ3R2c2hvdy5wb3N0ZXInOiBpWydwb3N0ZXInXSwgJ3NlYXNvbi5wb3N0ZXInOiBpWydwb3N0ZXInXX0pCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIGFydC51cGRhdGUoeydwb3N0ZXInOiBhZGRvblBvc3Rlcn0pCgogICAgICAgICAgICAgICAgaWYgJ3RodW1iJyBpbiBpIGFuZCBub3QgaVsndGh1bWInXSA9PSAnMCc6CiAgICAgICAgICAgICAgICAgICAgYXJ0LnVwZGF0ZSh7J2ljb24nOiBpWyd0aHVtYiddLCAndGh1bWInOiBpWyd0aHVtYiddfSkKICAgICAgICAgICAgICAgIGVsaWYgJ2ZhbmFydCcgaW4gaSBhbmQgbm90IGlbJ2ZhbmFydCddID09ICcwJzoKICAgICAgICAgICAgICAgICAgICBhcnQudXBkYXRlKHsnaWNvbic6IGlbJ2ZhbmFydCddLCAndGh1bWInOiBpWydmYW5hcnQnXX0pCiAgICAgICAgICAgICAgICBlbGlmICdwb3N0ZXInIGluIGkgYW5kIG5vdCBpWydwb3N0ZXInXSA9PSAnMCc6CiAgICAgICAgICAgICAgICAgICAgYXJ0LnVwZGF0ZSh7J2ljb24nOiBpWydwb3N0ZXInXSwgJ3RodW1iJzogaVsncG9zdGVyJ119KQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBhcnQudXBkYXRlKHsnaWNvbic6IGFkZG9uRmFuYXJ0LCAndGh1bWInOiBhZGRvbkZhbmFydH0pCgogICAgICAgICAgICAgICAgaWYgJ2Jhbm5lcicgaW4gaSBhbmQgbm90IGlbJ2Jhbm5lciddID09ICcwJzoKICAgICAgICAgICAgICAgICAgICBhcnQudXBkYXRlKHsnYmFubmVyJzogaVsnYmFubmVyJ119KQogICAgICAgICAgICAgICAgZWxpZiAnZmFuYXJ0JyBpbiBpIGFuZCBub3QgaVsnZmFuYXJ0J10gPT0gJzAnOgogICAgICAgICAgICAgICAgICAgIGFydC51cGRhdGUoeydiYW5uZXInOiBpWydmYW5hcnQnXX0pCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIGFydC51cGRhdGUoeydiYW5uZXInOiBhZGRvbkJhbm5lcn0pCgogICAgICAgICAgICAgICAgaWYgc2V0dGluZ0ZhbmFydCA9PSAndHJ1ZScgYW5kICdmYW5hcnQnIGluIGkgYW5kIG5vdCBpWydmYW5hcnQnXSA9PSAnMCc6CiAgICAgICAgICAgICAgICAgICAgaXRlbS5zZXRQcm9wZXJ0eSgnRmFuYXJ0X0ltYWdlJywgaVsnZmFuYXJ0J10pCiAgICAgICAgICAgICAgICBlbGlmIG5vdCBhZGRvbkZhbmFydCA9PSBOb25lOgogICAgICAgICAgICAgICAgICAgIGl0ZW0uc2V0UHJvcGVydHkoJ0ZhbmFydF9JbWFnZScsIGFkZG9uRmFuYXJ0KQoKICAgICAgICAgICAgICAgIGl0ZW0uc2V0QXJ0KGFydCkKICAgICAgICAgICAgICAgIGl0ZW0uYWRkQ29udGV4dE1lbnVJdGVtcyhjbSkKICAgICAgICAgICAgICAgIGl0ZW0uc2V0UHJvcGVydHkoJ0lzUGxheWFibGUnLCBpc1BsYXlhYmxlKQogICAgICAgICAgICAgICAgaXRlbS5zZXRJbmZvKHR5cGU9J1ZpZGVvJywgaW5mb0xhYmVscyA9IG1ldGEpCgogICAgICAgICAgICAgICAgdmlkZW9fc3RyZWFtaW5mbyA9IHsnY29kZWMnOiAnaDI2NCd9CiAgICAgICAgICAgICAgICBpdGVtLmFkZFN0cmVhbUluZm8oJ3ZpZGVvJywgdmlkZW9fc3RyZWFtaW5mbykKCiAgICAgICAgICAgICAgICBjb250cm9sLmFkZEl0ZW0oaGFuZGxlPXN5c2hhbmRsZSwgdXJsPXVybCwgbGlzdGl0ZW09aXRlbSwgaXNGb2xkZXI9aXNGb2xkZXIpCiAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgY29udHJvbC5jb250ZW50KHN5c2hhbmRsZSwgJ2VwaXNvZGVzJykKICAgICAgICBjb250cm9sLmRpcmVjdG9yeShzeXNoYW5kbGUsIGNhY2hlVG9EaXNjPVRydWUpCiAgICAgICAgdmlld3Muc2V0VmlldygnZXBpc29kZXMnLCB7J3NraW4uZXN0dWFyeSc6IDU1LCAnc2tpbi5jb25mbHVlbmNlJzogNTA0fSkKCgogICAgZGVmIGFkZERpcmVjdG9yeShzZWxmLCBpdGVtcywgcXVldWU9RmFsc2UpOgogICAgICAgIGlmIGl0ZW1zID09IE5vbmUgb3IgbGVuKGl0ZW1zKSA9PSAwOiBjb250cm9sLmlkbGUoKSA7IHN5cy5leGl0KCkKCiAgICAgICAgc3lzYWRkb24gPSBzeXMuYXJndlswXQoKICAgICAgICBzeXNoYW5kbGUgPSBpbnQoc3lzLmFyZ3ZbMV0pCgogICAgICAgIGFkZG9uRmFuYXJ0LCBhZGRvblRodW1iLCBhcnRQYXRoID0gY29udHJvbC5hZGRvbkZhbmFydCgpLCBjb250cm9sLmFkZG9uVGh1bWIoKSwgY29udHJvbC5hcnRQYXRoKCkKCiAgICAgICAgcXVldWVNZW51ID0gY29udHJvbC5sYW5nKDMyMDY1KS5lbmNvZGUoJ3V0Zi04JykKCiAgICAgICAgZm9yIGkgaW4gaXRlbXM6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIG5hbWUgPSBpWyduYW1lJ10KCiAgICAgICAgICAgICAgICBpZiBpWydpbWFnZSddLnN0YXJ0c3dpdGgoJ2h0dHAnKTogdGh1bWIgPSBpWydpbWFnZSddCiAgICAgICAgICAgICAgICBlbGlmIG5vdCBhcnRQYXRoID09IE5vbmU6IHRodW1iID0gb3MucGF0aC5qb2luKGFydFBhdGgsIGlbJ2ltYWdlJ10pCiAgICAgICAgICAgICAgICBlbHNlOiB0aHVtYiA9IGFkZG9uVGh1bWIKCiAgICAgICAgICAgICAgICB1cmwgPSAnJXM/YWN0aW9uPSVzJyAlIChzeXNhZGRvbiwgaVsnYWN0aW9uJ10pCiAgICAgICAgICAgICAgICB0cnk6IHVybCArPSAnJnVybD0lcycgJSB1cmxsaWIucXVvdGVfcGx1cyhpWyd1cmwnXSkKICAgICAgICAgICAgICAgIGV4Y2VwdDogcGFzcwoKICAgICAgICAgICAgICAgIGNtID0gW10KCiAgICAgICAgICAgICAgICBpZiBxdWV1ZSA9PSBUcnVlOgogICAgICAgICAgICAgICAgICAgIGNtLmFwcGVuZCgocXVldWVNZW51LCAnUnVuUGx1Z2luKCVzP2FjdGlvbj1xdWV1ZUl0ZW0pJyAlIHN5c2FkZG9uKSkKCiAgICAgICAgICAgICAgICBpdGVtID0gY29udHJvbC5pdGVtKGxhYmVsPW5hbWUpCgogICAgICAgICAgICAgICAgaXRlbS5zZXRBcnQoeydpY29uJzogdGh1bWIsICd0aHVtYic6IHRodW1ifSkKICAgICAgICAgICAgICAgIGlmIG5vdCBhZGRvbkZhbmFydCA9PSBOb25lOiBpdGVtLnNldFByb3BlcnR5KCdGYW5hcnRfSW1hZ2UnLCBhZGRvbkZhbmFydCkKCiAgICAgICAgICAgICAgICBpdGVtLmFkZENvbnRleHRNZW51SXRlbXMoY20pCgogICAgICAgICAgICAgICAgY29udHJvbC5hZGRJdGVtKGhhbmRsZT1zeXNoYW5kbGUsIHVybD11cmwsIGxpc3RpdGVtPWl0ZW0sIGlzRm9sZGVyPVRydWUpCiAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgY29udHJvbC5jb250ZW50KHN5c2hhbmRsZSwgJ2FkZG9ucycpCiAgICAgICAgY29udHJvbC5kaXJlY3Rvcnkoc3lzaGFuZGxlLCBjYWNoZVRvRGlzYz1UcnVlKQoKCg==')